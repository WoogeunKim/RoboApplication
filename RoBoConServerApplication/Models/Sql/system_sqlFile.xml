<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="system" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >
  <statements>
    <!-- 시스템 분류 코드 -->
    <select id="S131SelectMasterCode" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
        CLSS_TP_CD
      , CLSS_TP_NM
      , SYS_FLG
      , SYS_AREA_CD
      , CLSS_CD_DESC
      , (CASE WHEN DELT_FLG = 'N' THEN '사용' ELSE '미사용' END) AS DELT_FLG
      , CHNL_CD
      FROM TB_SYS_CD
      WHERE 1=1
        AND CHNL_CD = #CHNL_CD#
      <isNotNull property="CLSS_TP_CD" >
        AND CLSS_TP_CD = #CLSS_TP_CD#
      </isNotNull>
      ORDER BY CLSS_TP_CD
    </select>

    <insert id="S131InsertMasterCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_CD(CLSS_TP_CD, CLSS_TP_NM, SYS_FLG, SYS_AREA_CD, CLSS_CD_DESC, DELT_FLG, CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT, CHNL_CD)
      VALUES(#CLSS_TP_CD#, #CLSS_TP_NM#, #SYS_FLG#, #SYS_AREA_CD#, #CLSS_CD_DESC#, #DELT_FLG#, #USR_ID#, GETDATE(), #USR_ID#, GETDATE(), #CHNL_CD#)
    </insert>

    <update id="S131UpdateMasterCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_SYS_CD
      SET CLSS_TP_NM = #CLSS_TP_NM#
        , SYS_FLG      = #SYS_FLG#
        , SYS_AREA_CD  = #SYS_AREA_CD#
        , CLSS_CD_DESC = #CLSS_CD_DESC#
        , DELT_FLG     = #DELT_FLG#
        , UPD_USR_ID   = #USR_ID#
        , UPD_DT       = GETDATE()
      WHERE CLSS_TP_CD  = #CLSS_TP_CD#
          AND CHNL_CD   = #CHNL_CD#
    </update>

    <select id="S131SelectDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
      CLSS_TP_CD
      , CLSS_CD
      , CLSS_DESC
      , CONVERT(CHAR(10), USE_ST_DT, 23) AS USE_ST_DT
      , CONVERT(CHAR(10), USE_END_DT, 23) AS USE_END_DT
      , CLSS_ORD_SEQ
      , CASE WHEN DELT_FLG = 'N' THEN '사용' ELSE '미사용' END AS DELT_FLG
      , CHNL_CD
      FROM TB_SYS_CLSS_CD
      WHERE 1=1
        AND CHNL_CD   = #CHNL_CD#
      <isNotNull property="CLSS_TP_CD" >
        AND CLSS_TP_CD = #CLSS_TP_CD#
      </isNotNull>
      <isNotNull property="CLSS_CD" >
        AND CLSS_CD = #CLSS_CD#
      </isNotNull>
      <isNotNull property="DELT_FLG" >
        AND DELT_FLG = #DELT_FLG#
      </isNotNull>
      ORDER BY CLSS_ORD_SEQ
    </select>

    <insert id="S131InsertDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_CLSS_CD(CLSS_TP_CD, CLSS_CD, CLSS_DESC, USE_ST_DT, USE_END_DT, CLSS_ORD_SEQ, DELT_FLG, CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT, CHNL_CD )
      VALUES(#CLSS_TP_CD#, #CLSS_CD#, #CLSS_DESC#, GETDATE(), CONVERT(DATETIME, #USE_END_DT#), #CLSS_ORD_SEQ#, #DELT_FLG#, #USR_ID#, GETDATE(), #USR_ID#, GETDATE(), #CHNL_CD#)
    </insert>

    <update id="S131UpdateDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_SYS_CLSS_CD
      SET CLSS_DESC    = #CLSS_DESC#
        , USE_END_DT   = CONVERT(DATETIME, #USE_END_DT#)
        , CLSS_ORD_SEQ = #CLSS_ORD_SEQ#
        , DELT_FLG     = #DELT_FLG#
        , UPD_USR_ID   = #USR_ID#
        , UPD_DT       = GETDATE()
      WHERE CLSS_TP_CD = #CLSS_TP_CD#
        AND CLSS_CD      = #CLSS_CD#
        AND CHNL_CD   = #CHNL_CD#
    </update>
    <!-- 시스템 분류 코드 -->


    <!-- 공지 사항 -->
    <select id="S1310SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
      ROW_NUMBER() OVER (PARTITION BY NULL ORDER BY CRE_DT) AS RN
      , NTC_NO
      , NTC_SEQ
      , TIT_DESC
      , SUBJ_DESC
      , INP_ID
      , dbo.USR_NM_FNC(CHNL_CD,INP_ID) AS INP_NM
      , CONVERT(VARCHAR, CRE_DT, 23) AS CRE_DT
      , FILE_NM
      , NTC_FILE
      , NTC_CLSS_CD
      , NTC_STS_CD
      , (CASE NTC_STS_CD WHEN 'R' THEN '접수'
      WHEN 'G' THEN '진행 중'  ELSE '완료' END) AS NTC_STS_NM
      , NTC_ANS_DESC
      , NTC_CD
      , (CASE NTC_STS_CD WHEN 'R' THEN 1
      WHEN 'G' THEN 0  ELSE 0 END) AS isCheckd
      , CHNL_CD
      , CONVERT(VARCHAR, UPD_DT, 23) AS UPD_DT
      FROM TB_SYS_NTC
      WHERE 1=1
      <isNotNull property="FM_DT">
        AND CRE_DT >= CAST(CONVERT(VARCHAR, #FM_DT#, 112) + ' 00:00:00' AS DATETIME)
        AND CRE_DT <![CDATA[<=]]> CAST(CONVERT(VARCHAR, #TO_DT#, 112) + ' 23:59:59' AS DATETIME)
      </isNotNull>
      AND CHNL_CD = #CHNL_CD#
      AND NTC_CLSS_CD = #NTC_CLSS_CD#
      AND NTC_CD = #NTC_CD#
    </select>

    <insert id="S1310InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_NTC
      (
      NTC_SEQ
      , TIT_DESC
      , SUBJ_DESC
      , INP_ID
      , CRE_USR_ID
      , CRE_DT
      , UPD_USR_ID
      , UPD_DT
      , FILE_NM
      , NTC_FILE
      , CHNL_CD
      , NTC_CLSS_CD
      , NTC_STS_CD
      , NTC_ANS_DESC
      , NTC_CD
      )
      VALUES
      (
      #NTC_SEQ#
      , #TIT_DESC#
      , #SUBJ_DESC#
      , #INP_ID#
      , #CRE_USR_ID#
      , GETDATE()
      , #UPD_USR_ID#
      , GETDATE()
      , #FILE_NM#
      , #NTC_FILE#
      , #CHNL_CD#
      , #NTC_CLSS_CD#
      , #NTC_STS_CD#
      , #NTC_ANS_DESC#
      , #NTC_CD#
      )
    </insert>

    <update id="S1310UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_SYS_NTC
      SET UPD_DT        = GETDATE()
      <isNotNull property="SUBJ_DESC" >
        , SUBJ_DESC     = #SUBJ_DESC#
      </isNotNull>
      <isNotNull property="FILE_NM" >
        , FILE_NM       = #FILE_NM#
      </isNotNull>
      <isNotNull property="NTC_FILE" >
        , NTC_FILE      = #NTC_FILE#
      </isNotNull>
      <isNotNull property="UPD_USR_ID" >
        , UPD_USR_ID    = #UPD_USR_ID#
      </isNotNull>
      <isNotNull property="TIT_DESC" >
        , TIT_DESC      = #TIT_DESC#
      </isNotNull>
      <isNotNull property="NTC_CLSS_CD" >
        , NTC_CLSS_CD   = #NTC_CLSS_CD#
      </isNotNull>
      <isNotNull property="NTC_STS_CD" >
        , NTC_STS_CD    = #NTC_STS_CD#
      </isNotNull>
      <isNotNull property="NTC_ANS_DESC" >
        , NTC_ANS_DESC  = #NTC_ANS_DESC#
      </isNotNull>
      WHERE NTC_NO   = #NTC_NO#
      AND NTC_SEQ  = #NTC_SEQ#
      AND NTC_CD = #NTC_CD#
      AND CHNL_CD  = #CHNL_CD#
    </update>

    <delete id="S1310DeleteMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_SYS_NTC
      WHERE 1 = 1
      AND NTC_NO   = #NTC_NO#
      AND NTC_SEQ  = #NTC_SEQ#
      AND NTC_CD = #NTC_CD#
      AND CHNL_CD = #CHNL_CD#
    </delete>
    <!-- 공지 사항 -->


	  <select id="S141SelectItemList_mini" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.ItemCodeVo">
		  SELECT
		        T1.ITM_CD
		      , T1.ITM_NM
		      , T1.ITM_SZ_NM
		      , T1.UOM_CD
		      , T1.UOM_NM
			    , T1.ITM_GRP_CLSS_NM
			    , T1.N1ST_ITM_GRP_NM
		      , T1.N2ND_ITM_GRP_NM
      FROM MV_TB_CD_ITM      T1
		   WHERE 1 = 1
		    AND T1.CHNL_CD =  #CHNL_CD#
		  <isNotNull property="ITM_CD" >
			  AND T1.ITM_CD = #ITM_CD#
		  </isNotNull>
		  <isNotNull property="ITM_NM" >
			  AND T1.ITM_NM = #ITM_NM#
		  </isNotNull>
		  <isNotNull property="ITM_GRP_CLSS_CD" >
			  AND T1.ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
		  </isNotNull>
      <isNotNull property="GBN" >
        AND SUBSTRING(T1.ITM_CD, 10, 2) = #GBN#
      </isNotNull>
		  <!--<isNotNull property="N1ST_ITM_GRP_CD" >
			  AND T1.N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
		  </isNotNull>
		  <isNotNull property="N2ND_ITM_GRP_CD" >
			  AND T1.N2ND_ITM_GRP_CD = #N2ND_ITM_GRP_CD#
		  </isNotNull>-->
		  <isNotNull property="DELT_FLG" >
			  AND T1.DELT_FLG = #DELT_FLG#
		  </isNotNull>
	  </select>
	  
	  
    <!-- 품목 마스터 등록 -->
    <select id="S141SelectItemList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
		SELECT
		      T1.ITM_CD
		    , T1.PROD_LOC_CD
		    , T1.PROD_LOC_NM
		    , T1.ITM_NM
		    , T1.ITM_SZ_NM
		    , T1.ITM_GRP_CLSS_CD
		    , T1.ITM_GRP_CLSS_NM
		    , T1.UOM_CD
		    , T1.UOM_NM
		    , ISNULL(T1.UOM_WGT, 0) AS UOM_WGT
		    , ISNULL(T1.UOM_RUN_WGT, 0) AS UOM_RUN_WGT
		    , ISNULL(T1.LD_TM_VAL, 0) AS LD_TM_VAL
		    , ISNULL(T1.LOT_VAL, 0) AS  LOT_VAL
		    , T1.ABC_CD
		    , T1.ABC_NM
		    , T1.ACT_INSP_CD
		    , T1.QLTY_INSP_CD
		    , ISNULL(T1.N1ST_ITM_GRP_CD, '') AS N1ST_ITM_GRP_CD
		    , T1.N1ST_ITM_GRP_NM
		    , T1.N2ND_ITM_GRP_CD
		    , T1.N2ND_ITM_GRP_NM
        , T1.N2ND_ITM_GRP_CD + ' / ' + dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-026', T1.N2ND_ITM_GRP_CD) AS GBN
		    , T1.ITM_ORD_CD
		    , ISNULL(T1.SFSTK_QTY, 0) AS  SFSTK_QTY
		    , T2.IMG
		    , CASE WHEN T1.DELT_FLG = 'N' THEN '사용' ELSE '미사용' END AS DELT_FLG
		    , T1.CAR_ITM_NM
		    , T1.ITM_PLSTE_NO
		    , T1.ITM_PLSTE_FILE_NM
		    , T1.ITM_PLSTE_FILE
		    , T1.CHNL_CD
		    , T1.MIN_TOR_VAL
		    , T1.MAX_TOR_VAL
		    , T1.INSP_ITM_GRP_CD
		    , 0  AS RN
		    , T1.ITM_STD_FILE
		    , T1.ITM_STD_FILE_NM
		    , T1.STO_TM_VAL
		    , T1.CYC_TM_VAL
		    , T1.TACT_TM_VAL
		    , CONVERT(VARCHAR, T1.PROD_RGST_DT, 23) AS PROD_RGST_DT
		    , T1.MOQ_QTY
		    , T1.MTRL_NM_CD
		    , T3.CAR_TP_NM  AS MTRL_NM_NM
		    , T1.N2ND_SUB_ITM_CD
		    , T1.N2ND_SUB_ITM_NM
		    , T1.ACT_INSP_FLG
		    , ISNULL(T1.PK_PER_QTY, 0) AS PK_PER_QTY
        , dbo.FN_splitValue(T1.ITM_CD, '-', 2) AS ITM_LEN_NM
		    <!--, T1.SFSTK_QTY-->
		FROM MV_TB_CD_ITM      T1
		LEFT OUTER JOIN TB_CD_ITM_IMG  T2
		ON (T1.ITM_CD  = T2.ITM_CD AND T1.CHNL_CD = T2.CHNL_CD)
		OUTER APPLY (
		SELECT CAR_TP_NM
		FROM TB_CD_CAR_TP AS X
		WHERE 1=1
		AND X.CHNL_CD     = T1.CHNL_CD
		AND X.CAR_TP_CD   = T1.MTRL_NM_CD
		) T3
		WHERE 1 = 1
		AND T1.CHNL_CD =  #CHNL_CD#
		<isNotNull property="ITM_CD" >
			AND T1.ITM_CD = #ITM_CD#
		</isNotNull>
		<isNotNull property="ITM_NM" >
			AND T1.ITM_NM = #ITM_NM#
		</isNotNull>
		<isNotNull property="ITM_GRP_CLSS_CD" >
			AND T1.ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
		</isNotNull>
		<isNotNull property="N1ST_ITM_GRP_CD" >
			AND T1.N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
		</isNotNull>
		<isNotNull property="N2ND_ITM_GRP_CD" >
			AND T1.N2ND_ITM_GRP_CD = #N2ND_ITM_GRP_CD#
		</isNotNull>
		<isNotNull property="DELT_FLG" >
			AND T1.DELT_FLG = #DELT_FLG#
		</isNotNull>
		
		
		<!--WITH TMP AS (
		SELECT  T1.ITM_CD
		, MAX(CASE WHEN GBN = 'L-100' THEN CLSS_DESC END) AS  PROD_LOC_NM
		, MAX(CASE WHEN GBN = 'L-001' THEN CLSS_DESC END) AS  ITM_GRP_CLSS_NM
		, MAX(CASE WHEN GBN = 'L-003' THEN CLSS_DESC END) AS  UOM_NM
		, MAX(CASE WHEN GBN = 'L-200' THEN CLSS_DESC END) AS  ABC_NM
		, MAX(CASE WHEN GBN = 'L-004' THEN CLSS_DESC END) AS  QLTY_INSP_NM
		, MAX(CASE WHEN GBN = 'Q-005' THEN CLSS_DESC END) AS  INSP_ITM_GRP_NM
		, MAX(CASE WHEN GBN = 'L-800' THEN CLSS_DESC END) AS  N2ND_SUB_ITM_NM
		, MAX(T2.ITM_QTY) AS ITM_STK_QTY
		FROM (
		        SELECT 'L-100'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		            ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       =  #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'L-100'
		            AND T1.PROD_LOC_CD   = T2.CLSS_CD
		        UNION ALL
		        SELECT 'L-001'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		         ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       =  #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'L-001'
		            AND T1.ITM_GRP_CLSS_CD   = T2.CLSS_CD
		        UNION ALL
		        SELECT 'L-003'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		         ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       =  #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'L-003'
		            AND T1.UOM_CD   = T2.CLSS_CD
		        UNION ALL
		        SELECT 'L-200'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		            ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       = #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'L-200'
		            AND T1.ABC_CD   = T2.CLSS_CD
		        UNION ALL
		        SELECT 'L-004'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		            ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       =  #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'L-004'
		            AND T1.QLTY_INSP_CD   = T2.CLSS_CD
		        UNION ALL
		        SELECT 'Q-005'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		            ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       =  #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'Q-005'
		            AND T1.INSP_ITM_GRP_CD   = T2.CLSS_CD
		        UNION ALL
		        SELECT 'L-800'       AS GBN
		            , T1.ITM_CD
		            , T2.CLSS_DESC
		        FROM TB_CD_ITM        T1
		            ,  TB_SYS_CLSS_CD   T2
		        WHERE 1 = 1
		            AND T1.CHNL_CD       =  #CHNL_CD#
		            AND T1.CHNL_CD       = T2.CHNL_CD
		            AND T2.CLSS_TP_CD    = 'L-800'
		            AND T1.N2ND_SUB_ITM_CD   = T2.CLSS_CD
		        ) T1 LEFT OUTER JOIN TB_INVT_DLY_STK T2 ON ( T1.ITM_CD = T2.ITM_CD AND T2.CHNL_CD = #CHNL_CD# )                     
		        GROUP BY T1.ITM_CD
		)
		SELECT
		    T1.ITM_CD
		    , T1.PROD_LOC_CD
		    , T3.PROD_LOC_NM
		    , T1.ITM_NM
		    , T1.ITM_SZ_NM
		    , T1.ITM_GRP_CLSS_CD
		    , T3.ITM_GRP_CLSS_NM
		    , T1.UOM_CD
		    , T3.UOM_NM
		    , ISNULL(T1.UOM_WGT, 0) AS UOM_WGT
			, ISNULL(T1.UOM_RUN_WGT, 0) AS UOM_RUN_WGT
		    , ISNULL(T1.LD_TM_VAL, 0) AS LD_TM_VAL
		    , ISNULL(T1.LOT_VAL, 0) AS  LOT_VAL
		    , T1.ABC_CD
		    , T3.ABC_NM
		    , T1.ACT_INSP_CD
		    , T1.QLTY_INSP_CD
		    , ISNULL(T1.N1ST_ITM_GRP_CD, '') AS N1ST_ITM_GRP_CD
		    , (SELECT  ISNULL(dbo.PUR_N1ST_GRP_NM_FNC(T1.CHNL_CD, T1.ITM_GRP_CLSS_CD, T1.N1ST_ITM_GRP_CD), '') FROM CPY_T WHERE NO = 1) AS N1ST_ITM_GRP_NM
		    , T1.N2ND_ITM_GRP_CD
		    , (SELECT  dbo.PUR_N2ST_GRP_NM_FNC(T1.CHNL_CD, T1.ITM_GRP_CLSS_CD, T1.N1ST_ITM_GRP_CD, T1.N2ND_ITM_GRP_CD) FROM CPY_T WHERE NO = 1) AS N2ND_ITM_GRP_NM
		    , T1.ITM_ORD_CD
		    , ISNULL(T1.SFSTK_QTY, 0) AS  SFSTK_QTY
		    , T2.IMG
		    , CASE WHEN T1.DELT_FLG = 'N' THEN '사용' ELSE '미사용' END AS DELT_FLG
		    , T1.CAR_ITM_NM
		    , T1.ITM_PLSTE_NO
		    , T1.ITM_PLSTE_FILE_NM
		    , T1.ITM_PLSTE_FILE
		    , T1.CHNL_CD
		    , T1.MIN_TOR_VAL
		    , T1.MAX_TOR_VAL
		    , T1.INSP_ITM_GRP_CD
		    , 0  AS RN
		    , T1.ITM_STD_FILE
		    , T1.ITM_STD_FILE_NM
		    , T1.STO_TM_VAL
		    , T1.CYC_TM_VAL
		    , T1.TACT_TM_VAL
		    , CONVERT(VARCHAR, T1.PROD_RGST_DT, 23) AS PROD_RGST_DT
		    , T1.MOQ_QTY
		    , T1.MTRL_NM_CD
		    , (SELECT  CAR_TP_NM FROM TB_CD_CAR_TP AS X WHERE 1=1 AND X.CHNL_CD = T1.CHNL_CD AND X.CAR_TP_CD = T1.MTRL_NM_CD) AS MTRL_NM_NM
		    , T1.N2ND_SUB_ITM_CD
			, T3.N2ND_SUB_ITM_NM
			, T1.ACT_INSP_FLG
			, ISNULL(T1.PK_PER_QTY, 0) AS PK_PER_QTY
			, T3.ITM_STK_QTY   AS SFSTK_QTY
		FROM TB_CD_ITM      T1
		LEFT OUTER JOIN TMP T3
		ON (
		    T1.ITM_CD = T3.ITM_CD
		)
		LEFT OUTER JOIN TB_CD_ITM_IMG  T2
		ON (T1.ITM_CD  = T2.ITM_CD AND T1.CHNL_CD = T2.CHNL_CD)
		WHERE 1 = 1
		AND T1.CHNL_CD = #CHNL_CD#
		<isNotNull property="ITM_CD" >
			AND T1.ITM_CD = #ITM_CD#
		</isNotNull>
		<isNotNull property="ITM_NM" >
			AND T1.ITM_NM = #ITM_NM#
		</isNotNull>
		<isNotNull property="ITM_GRP_CLSS_CD" >
			AND T1.ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
		</isNotNull>
		<isNotNull property="N1ST_ITM_GRP_CD" >
			AND T1.N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
		</isNotNull>
		<isNotNull property="N2ND_ITM_GRP_CD" >
			AND T1.N2ND_ITM_GRP_CD = #N2ND_ITM_GRP_CD#
		</isNotNull>
		<isNotNull property="DELT_FLG" >
			AND T1.DELT_FLG = #DELT_FLG#
		</isNotNull>-->
      <!--SELECT
            T1.ITM_CD
          , T1.PROD_LOC_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-100', T1.PROD_LOC_CD) AS PROD_LOC_NM
          , T1.ITM_NM
          , T1.ITM_SZ_NM
          , T1.ITM_GRP_CLSS_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-001', T1.ITM_GRP_CLSS_CD) AS ITM_GRP_CLSS_NM
          , T1.UOM_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-003', T1.UOM_CD) AS UOM_NM
          , ISNULL(T1.UOM_WGT, 0) AS UOM_WGT
          , ISNULL(T1.LD_TM_VAL, 0) AS LD_TM_VAL
          , ISNULL(T1.LOT_VAL, 0) AS  LOT_VAL
          , T1.ABC_CD
          , dbo.FF_ITM_INFO_A(T1.ITM_CD) AS ITM_INFO_A
          , dbo.FF_ITM_INFO_B(T1.ITM_CD) AS ITM_INFO_B
          , dbo.FF_ITM_INFO_C(T1.ITM_CD) AS ITM_INFO_C
          , dbo.FF_ITM_INFO_D(T1.ITM_CD) AS ITM_INFO_D
          , dbo.FF_ITM_INFO_E(T1.ITM_CD) AS ITM_INFO_E
          , dbo.FF_ITM_INFO_F(T1.ITM_CD) AS ITM_INFO_F
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-200', T1.ABC_CD) AS ABC_NM
          , T1.ACT_INSP_CD
          , T1.QLTY_INSP_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-004', T1.QLTY_INSP_CD) AS QLTY_INSP_NM
          , ISNULL(T1.N1ST_ITM_GRP_CD, '') AS N1ST_ITM_GRP_CD
          , ISNULL(dbo.PUR_N1ST_GRP_NM_FNC(T1.CHNL_CD, T1.ITM_GRP_CLSS_CD, T1.N1ST_ITM_GRP_CD), '') AS N1ST_ITM_GRP_NM
          , T1.N2ND_ITM_GRP_CD
          , dbo.PUR_N2ST_GRP_NM_FNC(T1.CHNL_CD, T1.ITM_GRP_CLSS_CD, T1.N1ST_ITM_GRP_CD, T1.N2ND_ITM_GRP_CD) AS N2ND_ITM_GRP_NM
          , T1.ITM_ORD_CD
          , ISNULL(T1.SFSTK_QTY, 0) AS  SFSTK_QTY
          , T2.IMG
          , CASE WHEN T1.DELT_FLG = 'N' THEN '사용' ELSE '미사용' END AS DELT_FLG
          , T1.CAR_ITM_NM
          , T1.ITM_PLSTE_NO
          , T1.ITM_PLSTE_FILE_NM
          , T1.ITM_PLSTE_FILE
          , T1.CHNL_CD
          , T1.MIN_TOR_VAL
          , T1.MAX_TOR_VAL
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'Q-005', T1.INSP_ITM_GRP_CD) AS INSP_ITM_GRP_NM
          , T1.INSP_ITM_GRP_CD
          , (SELECT COUNT(*) FROM TB_CD_ITM_PCK AS X WHERE 1=1 AND X.CHNL_CD = T1.CHNL_CD AND X.ITM_CD = T1.ITM_CD) AS RN 
          , T1.ITM_STD_FILE
          , T1.ITM_STD_FILE_NM
          , T1.STO_TM_VAL
          , T1.CYC_TM_VAL
          , T1.TACT_TM_VAL
          , CONVERT(VARCHAR, T1.PROD_RGST_DT, 23) AS PROD_RGST_DT
          , T1.MOQ_QTY
          , T1.MTRL_NM_CD
          , (SELECT X.CAR_TP_NM FROM TB_CD_CAR_TP AS X WHERE 1=1 AND X.CHNL_CD = T1.CHNL_CD AND X.CAR_TP_CD = T1.MTRL_NM_CD) AS MTRL_NM_NM
          --><!--
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'DH02', T1.MTRL_NM_CD) AS MTRL_NM_NM
          --><!--
          , T1.N2ND_SUB_ITM_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-800', T1.N2ND_SUB_ITM_CD) AS N2ND_SUB_ITM_NM
      FROM TB_CD_ITM      T1
      LEFT OUTER JOIN TB_CD_ITM_IMG  T2
      ON (T1.ITM_CD  = T2.ITM_CD AND T1.CHNL_CD = T2.CHNL_CD)
      WHERE 1 = 1
      AND T1.CHNL_CD = #CHNL_CD#
      <isNotNull property="ITM_CD" >
        AND T1.ITM_CD = #ITM_CD#
      </isNotNull>
      <isNotNull property="ITM_NM" >
        AND T1.ITM_NM = #ITM_NM#
      </isNotNull>
      <isNotNull property="ITM_GRP_CLSS_CD" >
        AND T1.ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
      </isNotNull>
      <isNotNull property="N1ST_ITM_GRP_CD" >
        AND T1.N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
      </isNotNull>
      <isNotNull property="N2ND_ITM_GRP_CD" >
        AND T1.N2ND_ITM_GRP_CD = #N2ND_ITM_GRP_CD#
      </isNotNull>
      <isNotNull property="DELT_FLG" >
        AND T1.DELT_FLG = #DELT_FLG#
        </isNotNull>-->
    </select>

    <insert id="S141InsertItemCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM
      (
      ITM_CD
      , PROD_LOC_CD
      , ITM_NM
      , ITM_SZ_NM
      , ITM_GRP_CLSS_CD
      , UOM_CD
      , UOM_WGT
      , LD_TM_VAL
      , LOT_VAL
      , ABC_CD
      , ACT_INSP_CD
      , QLTY_INSP_CD
      , N1ST_ITM_GRP_CD
      , N2ND_ITM_GRP_CD
      , ITM_ORD_CD
      , SFSTK_QTY
      , DELT_FLG
      , CAR_ITM_NM
      , CRE_USR_ID
      , CRE_DT
      , UPD_USR_ID
      , UPD_DT
      , ITM_PLSTE_NO
      , CHNL_CD
      , ITM_PLSTE_FILE_NM
      , ITM_PLSTE_FILE
      , MIN_TOR_VAL
      , MAX_TOR_VAL
      , INSP_ITM_GRP_CD
      , ITM_STD_FILE
      , ITM_STD_FILE_NM
      , STO_TM_VAL
      , CYC_TM_VAL
      , TACT_TM_VAL
      , PROD_RGST_DT
      , MOQ_QTY
      , MTRL_NM_CD
      , N2ND_SUB_ITM_CD
	  , ACT_INSP_FLG
	  , UOM_RUN_WGT
	  , PK_PER_QTY
      )
      VALUES
      (
      #ITM_CD#
      , #PROD_LOC_CD#
      , #ITM_NM#
      , #ITM_SZ_NM#
      , #ITM_GRP_CLSS_CD#
      , #UOM_CD#
      , #UOM_WGT#
      , #LD_TM_VAL#
      , #LOT_VAL#
      , #ABC_CD#
      , #ACT_INSP_CD#
      , #QLTY_INSP_CD#
      , #N1ST_ITM_GRP_CD#
      , #N2ND_ITM_GRP_CD#
      , #ITM_ORD_CD#
      , #SFSTK_QTY#
      , #DELT_FLG#
      , #CAR_ITM_NM#
      , #CRE_USR_ID#
      , GETDATE()
      , #UPD_USR_ID#
      , GETDATE()
      , #ITM_PLSTE_NO#
      , #CHNL_CD#
      , #ITM_PLSTE_FILE_NM#
      , #ITM_PLSTE_FILE#
      , #MIN_TOR_VAL#
      , #MAX_TOR_VAL#
      , #INSP_ITM_GRP_CD#
      , #ITM_STD_FILE#
      , #ITM_STD_FILE_NM#
      , #STO_TM_VAL#
      , #CYC_TM_VAL#
      , #TACT_TM_VAL#
      , #PROD_RGST_DT#
      , #MOQ_QTY#
      , #MTRL_NM_CD#
      , #N2ND_SUB_ITM_CD#
	  , #ACT_INSP_FLG#
	  , #UOM_RUN_WGT#
	  , #PK_PER_QTY#
      )
    </insert>

    <update id="S141UpdateItemCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		UPDATE TB_CD_ITM
		SET  PROD_LOC_CD      = #PROD_LOC_CD#
		, ITM_NM           = #ITM_NM#
		, ITM_SZ_NM        = #ITM_SZ_NM#
		, ITM_GRP_CLSS_CD  = #ITM_GRP_CLSS_CD#
		, UOM_CD           = #UOM_CD#
		, UOM_WGT          = #UOM_WGT#
		, LD_TM_VAL        = #LD_TM_VAL#
		, LOT_VAL          = #LOT_VAL#
		, ABC_CD           = #ABC_CD#
		, ACT_INSP_CD      = #ACT_INSP_CD#
		, QLTY_INSP_CD     = #QLTY_INSP_CD#
		, N1ST_ITM_GRP_CD  = #N1ST_ITM_GRP_CD#
		, N2ND_ITM_GRP_CD  = #N2ND_ITM_GRP_CD#
		, ITM_ORD_CD       = #ITM_ORD_CD#
		, SFSTK_QTY        = #SFSTK_QTY#
		, DELT_FLG         = #DELT_FLG#
		, UPD_USR_ID       = #UPD_USR_ID#
		, UPD_DT           = GETDATE()
		, ITM_PLSTE_NO     = #ITM_PLSTE_NO#
		, ITM_PLSTE_FILE_NM = #ITM_PLSTE_FILE_NM#
		, ITM_PLSTE_FILE   = #ITM_PLSTE_FILE#
		, MIN_TOR_VAL      = #MIN_TOR_VAL#
		, MAX_TOR_VAL      = #MAX_TOR_VAL#
		, INSP_ITM_GRP_CD  = #INSP_ITM_GRP_CD#
		, CAR_ITM_NM       = #CAR_ITM_NM#
		, ITM_STD_FILE     = #ITM_STD_FILE#
		, ITM_STD_FILE_NM  = #ITM_STD_FILE_NM#
		, STO_TM_VAL       = #STO_TM_VAL#
		, CYC_TM_VAL       = #CYC_TM_VAL#
		, TACT_TM_VAL      = #TACT_TM_VAL#
		, PROD_RGST_DT     = #PROD_RGST_DT#
		, MOQ_QTY          = #MOQ_QTY#
		, MTRL_NM_CD       = #MTRL_NM_CD#
		, N2ND_SUB_ITM_CD  = #N2ND_SUB_ITM_CD#
		, ACT_INSP_FLG     = #ACT_INSP_FLG#
		, UOM_RUN_WGT     = #UOM_RUN_WGT#
		, PK_PER_QTY     = #PK_PER_QTY#
		WHERE 1 = 1
		AND ITM_CD  = #ITM_CD#
		AND CHNL_CD = #CHNL_CD#
	</update>

    <delete id="S141DeleteItemCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_CD_ITM
      WHERE 1 = 1
      AND ITM_CD = #ITM_CD#
      AND CHNL_CD = #CHNL_CD#
    </delete>

    <insert id="S141InsertItemImg" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_IMG
      (
      ITM_CD
      , IMG
      , CRE_USR_ID
      , CRE_DT
      , UPD_USR_ID
      , UPD_DT
      , CHNL_CD
      ) VALUES (
      #ITM_CD#
      , #IMG#
      , #CRE_USR_ID#
      , GETDATE()
      , #UPD_USR_ID#
      , GETDATE()
      , #CHNL_CD#
      )
    </insert>

    <update id="S141UpdateItemImg" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_CD_ITM_IMG
      SET IMG = #IMG#
      , UPD_USR_ID = #UPD_USR_ID#
      , UPD_DT = GETDATE()
      WHERE 1 = 1
      AND ITM_CD = #ITM_CD#
      AND CHNL_CD = #CHNL_CD#
    </update>

    <delete id="S141DeleteItemImg" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM    TB_CD_ITM_IMG
      WHERE 1 = 1
      AND ITM_CD = #ITM_CD#
      AND CHNL_CD = #CHNL_CD#
    </delete>
    <!-- 품목 마스터 등록 -->
    
    
    <!--품목 그룹 등록-->
    <select id="S133SelectCodeItemGroupList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT  ITM_GRP_CD
        , ITM_GRP_NM
        , ITM_GRP_CLSS_CD
        , dbo.CD_SYS_CLSS_FNC(CHNL_CD, 'L-001', ITM_GRP_CLSS_CD) AS ITM_GRP_CLSS_NM
        , PRNT_ITM_GRP_CD
        , CASE WHEN DELT_FLG = 'N' THEN '사용' ELSE '미사용' END AS DELT_FLG
        , '[' + ITM_GRP_CD + '] ' + ITM_GRP_NM AS ITM_GRP_RP_NM 
        , CHNL_CD
      FROM TB_CD_ITM_GRP
      WHERE 1 = 1
        AND CHNL_CD = #CHNL_CD#
      <!-- 중복 검사 아니면 -->
      <isNotEqual property="CRE_USR_ID" compareValue="dup">
        <!-- 대 분류 -->
        <isNull property="PRNT_ITM_GRP_CD">
          AND PRNT_ITM_GRP_CD = 'T'
        </isNull>

        <!-- 중 분류 -->
        <isNotNull property="PRNT_ITM_GRP_CD">
          AND PRNT_ITM_GRP_CD != 'T'
        </isNotNull>
        <isNotNull property="N1ST_ITM_GRP_CD">
          AND PRNT_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
        </isNotNull>
        <isNotNull property="DELT_FLG" >
          AND DELT_FLG = #DELT_FLG#
        </isNotNull>
         <isNotNull property="ITM_GRP_CLSS_CD" >
          AND ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
        </isNotNull>
      </isNotEqual>
        
      <!-- 중복 검사 분류 -->
      <isEqual property="CRE_USR_ID" compareValue="dup">
        <isNotNull property="ITM_GRP_CD" >
          AND ITM_GRP_CD = #ITM_GRP_CD#
        </isNotNull>
        <isNotNull property="PRNT_ITM_GRP_CD" >
          AND PRNT_ITM_GRP_CD = #PRNT_ITM_GRP_CD#
        </isNotNull>
      </isEqual>
    </select>

    <insert id="S133InsertItmGroupCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_GRP (
      ITM_GRP_CD
      , ITM_GRP_NM
      , ITM_GRP_CLSS_CD
      , PRNT_ITM_GRP_CD
      , DELT_FLG
      , CRE_DT
      , CRE_USR_ID
      , UPD_USR_ID
      , UPD_DT
      , CHNL_CD
      ) VALUES (
      #ITM_GRP_CD#
      , #ITM_GRP_NM#
      , #ITM_GRP_CLSS_CD#
      , #PRNT_ITM_GRP_CD#
      , #DELT_FLG#
      , GETDATE()
      , #CRE_USR_ID#
      , #UPD_USR_ID#
      , GETDATE()
      , #CHNL_CD#
      )
    </insert>

    <update id="S133UpdateItemGroupCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_CD_ITM_GRP
      SET ITM_GRP_NM      = #ITM_GRP_NM#
        , ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
        , DELT_FLG        = #DELT_FLG#
        , UPD_USR_ID      = #UPD_USR_ID#
        , UPD_DT          = GETDATE()
      WHERE 1 = 1
        AND ITM_GRP_CD       = #ITM_GRP_CD#
        AND ITM_GRP_CLSS_CD  = #ITM_GRP_CLSS_CD#
        AND PRNT_ITM_GRP_CD  = #PRNT_ITM_GRP_CD#
        AND CHNL_CD          = #CHNL_CD#
    </update>
    
    <delete id="S133DeleteItemGroupCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_CD_ITM_GRP
       WHERE 1 = 1
        AND ITM_GRP_CD       = #ITM_GRP_CD#
        AND ITM_GRP_CLSS_CD  = #ITM_GRP_CLSS_CD#
        AND PRNT_ITM_GRP_CD  = #PRNT_ITM_GRP_CD#
        AND CHNL_CD          = #CHNL_CD#
    </delete>
    <!--품목 그룹 등록-->
    
    
    
    <!-- 품목 포장 등록 -->
     <select id="S1149SelectMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT CHNL_CD
         , ITM_CD
         , N1ST_UOM_CD
         , dbo.CD_SYS_CLSS_FNC(CHNL_CD, 'L-003', N1ST_UOM_CD)  AS N1ST_UOM_NM 
         , N1ST_QTY
         , N1ST_WGT
         , N2ND_UOM_CD
         , dbo.CD_SYS_CLSS_FNC(CHNL_CD, 'L-003', N2ND_UOM_CD)  AS N2ND_UOM_NM     
         , N2ND_QTY
         , N2ND_WGT
      FROM TB_CD_ITM_PCK
        WHERE 1 = 1
          AND CHNL_CD = #CHNL_CD#
          <isNotNull property="ITM_CD" >
            AND ITM_CD = #ITM_CD#
          </isNotNull>
    </select>

     <insert id="S1149InsertMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_PCK 
      ( 
            CHNL_CD
          , ITM_CD
          , N1ST_UOM_CD
          , N1ST_QTY
          , N1ST_WGT
          , N2ND_UOM_CD
          , N2ND_QTY
          , N2ND_WGT
          , CRE_USR_ID
          , CRE_DT
          , UPD_USR_ID
          , UPD_DT  
      ) 
      VALUES 
      (
         #CHNL_CD#
        , #ITM_CD#
        , #N1ST_UOM_CD#
        , #N1ST_QTY#
        , #N1ST_WGT#
        , #N2ND_UOM_CD#
        , #N2ND_QTY#
        , #N2ND_WGT#
        , #CRE_USR_ID#
        , GETDATE()
        , #UPD_USR_ID#
        , GETDATE()
      )
    </insert>

    <update id="S1149UpdateMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_CD_ITM_PCK  
       SET N1ST_QTY       = #N1ST_QTY#
         , N1ST_WGT       = #N1ST_WGT#
         , N1ST_UOM_CD    = #N1ST_UOM_CD#
         , N2ND_UOM_CD    = #N2ND_UOM_CD#
         , N2ND_QTY       = #N2ND_QTY#
         , N2ND_WGT       = #N2ND_WGT#
         , UPD_USR_ID     = #UPD_USR_ID#
         , UPD_DT         = GETDATE()
     WHERE 1 = 1  
       AND CHNL_CD        = #CHNL_CD#
       AND ITM_CD         = #ITM_CD#
    </update>
    
    <delete id="S1149DeleteMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
     DELETE FROM TB_CD_ITM_PCK
     WHERE 1 = 1  
       AND CHNL_CD = #CHNL_CD#
       AND ITM_CD  = #ITM_CD#
    </delete>
    <!-- 품목 포장 등록 -->
      
      
    
    <!-- 거래처 관리 -->
    <select id="S143SelectCodeList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
        T1.CO_NO
      , T1.CO_NM
      , (CASE WHEN T1.DELT_FLG = 'N' THEN '사용' ELSE '미사용' END) AS DELT_FLG
      , T1.CHNL_CD
      FROM TB_CD_CO T1
      WHERE 1 = 1
      AND T1.CHNL_CD = #CHNL_CD#
      <isNotNull property="SEEK">
        AND (T1.CO_NO IN (
        SELECT CO_NO
        FROM TB_CD_CO_TP
        WHERE CO_TP_CD = #SEEK_AP#
        UNION ALL
        SELECT CO_NO
        FROM TB_CD_CO_TP
        WHERE CO_TP_CD = #SEEK_AR#
        UNION ALL
        SELECT CO_NO
        FROM TB_CD_CO_TP
        WHERE CO_TP_CD = #SEEK_OR#
        UNION ALL
        SELECT CO_NO
        FROM TB_CD_CO_TP
        WHERE CO_TP_CD = #SEEK_SU#
        ) OR  NOT EXISTS (SELECT 'X' FROM TB_CD_CO_TP Z WHERE Z.CO_NO = T1.CO_NO))
      </isNotNull>
      <isNotNull property="CO_NO">
        AND T1.CO_NO = #CO_NO#
      </isNotNull>
    </select>

    <select id="S143SelectCustomerDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT TOP 1
      CO_NO
      , CO_NM
      , CO_RGST_NO
      , PRSD_NM
      , HDQTR_PHN_NO
      , dbo.FF_CD_CO_TP_NM(CO_NO) AS CO_TP_NM
      , N1ST_BIZ_COND_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-002', N1ST_BIZ_COND_CD) AS N1ST_BIZ_COND_NM
      , N1ST_BZTP_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-003', N1ST_BZTP_CD) AS N1ST_BZTP_NM
      , CO_CLSS_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-006', CO_CLSS_CD) AS CO_CLSS_NM
      , CO_TP_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-005', CO_TP_CD) AS CO_TP_NM
      , DUE_DT_PRD_DY
      , BSE_CURR_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-007', BSE_CURR_CD) AS BSE_CURR_NM
      , INTERRLT_CO_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-010', INTERRLT_CO_CD) AS INTERRLT_CO_NM
      , (CASE WHEN DELT_FLG = 'N' THEN '사용' ELSE '미사용' END) AS DELT_FLG
      , PUR_CLZ_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-013', PUR_CLZ_CD) AS PUR_CLZ_NM
      , CNTC_MAN_NM
      , CNTC_MAN_PSN_NM
      , CNTC_MAN_PHN_NO
      , CNTC_MAN_EML
      , N2ND_CNTC_MAN_NM
      , N2ND_CNTC_MAN_PHN_NO
      , N2ND_CNTC_MAN_EML
      , N2ND_CNTC_MAN_PSN_NM
      , TAX_MAN_NM
      , TAX_MAN_PHN_NO
      , TAX_MAN_PSN_NM
      , TAX_MAN_EML
      , HDQTR_PST_NO
      , HDQTR_ADDR
      , HDQTR_FAX_NO
      , N1ST_AREA_PST_NO
      , N1ST_AREA_ADDR
      , N1ST_AREA_PHN_NO
      , N1ST_AREA_FAX_NO
      , N2ND_AREA_PST_NO
      , N2ND_AREA_ADDR
      , N2ND_AREA_PHN_NO
      , N2ND_AREA_FAX_NO
      , N1ST_AREA_NM
      , N2ND_AREA_NM
      , HDQTR_AREA_NM
      , CO_RMK
      , CHNL_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'L-013', TRD_CATE_CD) AS TRD_CATE_NM
      , TRD_CATE_CD
	  , ACCT_HLD_NM
	  , ACCT_NO
	  , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-031', BILL_CD) AS BILL_NM
	  , BILL_CD
	  , BANK_CD
	  , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'L-014', BANK_CD) AS BANK_NM
	  , HMPG_ADDR
      FROM TB_CD_CO
      WHERE 1=1
      AND CO_NO = #CO_NO#
      AND CHNL_CD = #CHNL_CD#
    </select>

    <insert id="S143InsertCustomerDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_CO
      ( CO_NO,
      CO_NM,
      CO_RGST_NO,
      PRSD_NM,
      INTERRLT_CO_CD,
      CO_CLSS_CD,
      CO_TP_CD,
      N1ST_BIZ_COND_CD,
      N1ST_BZTP_CD,
      N2ND_BIZ_COND_CD,
      N2ND_BZTP_CD,
      BSE_CURR_CD,
      DUE_DT_PRD_DY,
      CNTC_MAN_NM,
      CNTC_MAN_PSN_NM,
      CNTC_MAN_PHN_NO,
      CNTC_MAN_EML,
      TAX_MAN_NM,
      TAX_MAN_PSN_NM,
      TAX_MAN_PHN_NO,
      TAX_MAN_EML,
      HDQTR_ADDR,
      HDQTR_PHN_NO,
      HDQTR_FAX_NO,
      CRE_USR_ID,
      CRE_DT,
      UPD_USR_ID,
      UPD_DT,
      DELT_FLG,
      PUR_CLZ_CD,
      N2ND_CNTC_MAN_NM,
      N2ND_CNTC_MAN_PHN_NO,
      N2ND_CNTC_MAN_EML,
      N2ND_CNTC_MAN_PSN_NM,
      N1ST_AREA_PST_NO,
      N1ST_AREA_ADDR,
      N1ST_AREA_PHN_NO,
      N1ST_AREA_FAX_NO,
      N2ND_AREA_PST_NO,
      N2ND_AREA_ADDR,
      N2ND_AREA_PHN_NO,
      N2ND_AREA_FAX_NO,
      HDQTR_PST_NO,
      N1ST_AREA_NM,
      N2ND_AREA_NM,
      HDQTR_AREA_NM,
      CO_RMK,
      CHNL_CD,
      TRD_CATE_CD, 
	  ACCT_HLD_NM,
	  ACCT_NO,
	  BILL_CD,
	  BANK_CD,
	  HMPG_ADDR
	  )
      VALUES
	  (
      #CO_NO#,
      #CO_NM#,
      #CO_RGST_NO#,
      #PRSD_NM#,
      #INTERRLT_CO_CD#,
      #CO_CLSS_CD#,
      #CO_TP_CD#,
      #N1ST_BIZ_COND_CD#,
      #N1ST_BZTP_CD#,
      #N2ND_BIZ_COND_CD#,
      #N2ND_BZTP_CD#,
      #BSE_CURR_CD#,
      #DUE_DT_PRD_DY#,
      #CNTC_MAN_NM#,
      #CNTC_MAN_PSN_NM#,
      #CNTC_MAN_PHN_NO#,
      #CNTC_MAN_EML#,
      #TAX_MAN_NM#,
      #TAX_MAN_PSN_NM#,
      #TAX_MAN_PHN_NO#,
      #TAX_MAN_EML#,
      #HDQTR_ADDR#,
      #HDQTR_PHN_NO#,
      #HDQTR_FAX_NO#,
      #CRE_USR_ID#,
      GETDATE(),
      #UPD_USR_ID#,
      GETDATE(),
      #DELT_FLG#,
      #PUR_CLZ_CD#,
      #N2ND_CNTC_MAN_NM#,
      #N2ND_CNTC_MAN_PHN_NO#,
      #N2ND_CNTC_MAN_EML#,
      #N2ND_CNTC_MAN_PSN_NM#,
      #N1ST_AREA_PST_NO#,
      #N1ST_AREA_ADDR#,
      #N1ST_AREA_PHN_NO#,
      #N1ST_AREA_FAX_NO#,
      #N2ND_AREA_PST_NO#,
      #N2ND_AREA_ADDR#,
      #N2ND_AREA_PHN_NO#,
      #N2ND_AREA_FAX_NO#,
      #HDQTR_PST_NO#,
      #N1ST_AREA_NM#,
      #N2ND_AREA_NM#,
      #HDQTR_AREA_NM#,
      #CO_RMK#,
      #CHNL_CD#,
      #TRD_CATE_CD#,
	  #ACCT_HLD_NM#,
	  #ACCT_NO#,
	  #BILL_CD#,
	  #BANK_CD#,
	  #HMPG_ADDR#
      )
    </insert>

    <update id="S143UpdateCustomerDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      update TB_CD_CO
      SET
      CO_NO = #CO_NO#
      ,CO_NM = #CO_NM#
      ,CO_RGST_NO = #CO_RGST_NO#
      ,INTERRLT_CO_CD = #INTERRLT_CO_CD#
      ,PRSD_NM = #PRSD_NM#
      ,CO_CLSS_CD = #CO_CLSS_CD#
      ,CO_TP_CD = #CO_TP_CD#
      ,N1ST_BIZ_COND_CD = #N1ST_BIZ_COND_CD#
      ,N1ST_BZTP_CD = #N1ST_BZTP_CD#
      ,N2ND_BIZ_COND_CD = #N2ND_BIZ_COND_CD#
      ,N2ND_BZTP_CD = #N2ND_BZTP_CD#
      ,BSE_CURR_CD = #BSE_CURR_CD#
      ,DUE_DT_PRD_DY = #DUE_DT_PRD_DY#
      ,CNTC_MAN_NM = #CNTC_MAN_NM#
      ,CNTC_MAN_PSN_NM = #CNTC_MAN_PSN_NM#
      ,CNTC_MAN_PHN_NO = #CNTC_MAN_PHN_NO#
      ,CNTC_MAN_EML = #CNTC_MAN_EML#
      ,TAX_MAN_NM = #TAX_MAN_NM#
      ,TAX_MAN_PSN_NM = #TAX_MAN_PSN_NM#
      ,TAX_MAN_PHN_NO = #TAX_MAN_PHN_NO#
      ,TAX_MAN_EML = #TAX_MAN_EML#
      ,HDQTR_ADDR = #HDQTR_ADDR#
      ,HDQTR_PHN_NO = #HDQTR_PHN_NO#
      ,HDQTR_FAX_NO = #HDQTR_FAX_NO#
      ,CRE_USR_ID = #CRE_USR_ID#
      ,CRE_DT = getdate()
      ,DELT_FLG = #DELT_FLG#
      ,PUR_CLZ_CD = #PUR_CLZ_CD#
      ,N2ND_CNTC_MAN_NM = #N2ND_CNTC_MAN_NM#
      ,N2ND_CNTC_MAN_PHN_NO = #N2ND_CNTC_MAN_PHN_NO#
      ,N2ND_CNTC_MAN_EML = #N2ND_CNTC_MAN_EML#
      ,N2ND_CNTC_MAN_PSN_NM = #N2ND_CNTC_MAN_PSN_NM#
      ,N1ST_AREA_PST_NO = #N1ST_AREA_PST_NO#
      ,N1ST_AREA_ADDR = #N1ST_AREA_ADDR#
      ,N1ST_AREA_PHN_NO = #N1ST_AREA_PHN_NO#
      ,N1ST_AREA_FAX_NO = #N1ST_AREA_FAX_NO#
      ,N2ND_AREA_PST_NO = #N2ND_AREA_PST_NO#
      ,N2ND_AREA_ADDR = #N2ND_AREA_ADDR#
      ,N2ND_AREA_PHN_NO = #N2ND_AREA_PHN_NO#
      ,N2ND_AREA_FAX_NO = #N2ND_AREA_FAX_NO#
      ,HDQTR_PST_NO = #HDQTR_PST_NO#
      ,N1ST_AREA_NM = #N1ST_AREA_NM#
      ,N2ND_AREA_NM = #N2ND_AREA_NM#
      ,HDQTR_AREA_NM = #HDQTR_AREA_NM#
      ,CO_RMK = #CO_RMK#
      ,TRD_CATE_CD = #TRD_CATE_CD#
	  ,ACCT_HLD_NM = #ACCT_HLD_NM#
	  ,ACCT_NO = #ACCT_NO#
	  ,BILL_CD = #BILL_CD#
	  ,BANK_CD = #BANK_CD#
	  ,HMPG_ADDR = #HMPG_ADDR#
      WHERE CO_NO = #CO_NO#
      AND CHNL_CD = #CHNL_CD#
    </update>

    <delete id="S143DeleteCustomerDetailCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_CD_CO
      WHERE 1 = 1
      AND CO_NO  = #CO_NO#
      AND CHNL_CD = #CHNL_CD#
    </delete>

    <select id="S143SelectCustomerClassList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
      CO_NO
      , CO_TP_CD
      , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-004', CO_TP_CD) AS CO_TP_NM
      , CO_GRD_CD
      , CHNL_CD
      FROM TB_CD_CO_TP
      WHERE 1 = 1
      AND CHNL_CD = #CHNL_CD#
      <isNotNull property="CO_NO" >
        AND CO_NO = #CO_NO#
      </isNotNull>
    </select>

    <insert id="S143InsertCustomerClassCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_CO_TP
      (CO_NO,
      CO_TP_CD,
      CO_GRD_CD,
      CRE_USR_ID,
      CRE_DT,
      UPD_USR_ID,
      UPD_DT,
      CHNL_CD)
      VALUES
      (#CO_NO#,
      #CO_TP_CD#,
      #CO_GRD_CD#,
      #CRE_USR_ID#,
      GETDATE(),
      #UPD_USR_ID#,
      GETDATE(),
      #CHNL_CD#)
    </insert>

    <delete id="S143DeleteCustomerClassCode" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_CD_CO_TP
      WHERE 1 = 1
      AND CO_NO  = #CO_NO#
      AND CHNL_CD = #CHNL_CD#
    </delete>


    <!--
    <select id="SelectCustomerCode" parameterClass="CpcErpServer.Service.Code.Vo.SystemCodeVo" resultClass="CpcErpServer.Service.Code.Vo.SystemCodeVo">
      SELECT
      CO_NO
      , CO_NM
      , CO_RGST_NO
      , PRSD_NM
      , CHNL_CD
      FROM TB_CD_CO T1
      WHERE 1=1
      AND T1.CHNL_CD = #CHNL_CD#
      <isNotNull property="DELT_FLG" >
        AND T1.DELT_FLG = #DELT_FLG#
      </isNotNull>
      <isNotNull property="SEEK" >
        AND (T1.CO_NO IN (
        SELECT CO_NO
        FROM TB_CD_CO_TP
        WHERE CO_TP_CD = #SEEK#
        ) OR  NOT EXISTS (SELECT 'X' FROM TB_CD_CO_TP Z WHERE Z.CO_NO = T1.CO_NO))
      </isNotNull>
    </select>
    -->
    <!-- 거래처 관리 -->



    <!-- 제품 단가 등록 -->
    <select id="S1145SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
      dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-002', T1.AREA_CD) AS AREA_NM
      , T1.AREA_CD
      , T1.ITM_CD
      , T2.ITM_NM
      , T2.ITM_SZ_NM
      , CONVERT(VARCHAR, T1.ST_APLY_DT, 23) AS ST_APLY_DT
      , CONVERT(VARCHAR, T1.END_APLY_DT, 23) AS END_APLY_DT
      , T1.ITM_PRC
      , T2.ITM_GRP_CLSS_CD
      , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-001', T2.ITM_GRP_CLSS_CD) AS ITM_GRP_CLSS_NM
      , T2.N1ST_ITM_GRP_CD
      , dbo.PUR_N1ST_GRP_NM_FNC(T1.CHNL_CD, T2.ITM_GRP_CLSS_CD,  T2.N1ST_ITM_GRP_CD) AS  N1ST_ITM_GRP_NM
      , T2.N2ND_ITM_GRP_CD
      , dbo.PUR_N2ST_GRP_NM_FNC(T1.CHNL_CD, T2.ITM_GRP_CLSS_CD,  T2.N1ST_ITM_GRP_CD, T2.N2ND_ITM_GRP_CD) AS N2ND_ITM_GRP_NM
      , CONVERT(VARCHAR, T1.ST_APLY_DT, 23) + '~' + CONVERT(VARCHAR, T1.END_APLY_DT, 23) AS TIT_DESC
      , T1.CHNL_CD
      FROM TB_CD_SLPRC  T1
      ,  TB_CD_ITM    T2
      WHERE 1 = 1
      AND T1.ITM_CD       = T2.ITM_CD
      AND T1.CHNL_CD      = T2.CHNL_CD
      AND T1.AREA_CD      = #AREA_CD#
      AND T1.CHNL_CD      = #CHNL_CD#
      <isNotNull property="FM_DT">
        AND T1.ST_APLY_DT   <![CDATA[<=]]> CAST(CONVERT(VARCHAR, #FM_DT#, 112) + ' 23:59:59' AS DATETIME)
        AND T1.END_APLY_DT  >= CAST(CONVERT(VARCHAR, #FM_DT#, 112) + ' 23:59:59' AS DATETIME)
      </isNotNull>
      <isNotNull property="ITM_GRP_CLSS_CD">
        AND T2.ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
      </isNotNull>
      <isNotNull property="N1ST_ITM_GRP_CD">
        AND T2.N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
      </isNotNull>
      <isNotNull property="ITM_CD">
        AND T1.ITM_CD          = #ITM_CD#
      </isNotNull>
      <isNotNull property="ST_APLY_DT">
        AND CONVERT(VARCHAR, T1.ST_APLY_DT, 23)   = #ST_APLY_DT#
      </isNotNull>
      <isNotNull property="END_APLY_DT">
        AND CONVERT(VARCHAR, T1.END_APLY_DT, 23)  = #END_APLY_DT#
      </isNotNull>
      <!--AND T2.N2ND_ITM_GRP_CD = #N2ND_ITM_GRP_CD#-->
      ORDER BY T2.ITM_GRP_CLSS_CD, T2.N1ST_ITM_GRP_CD, T2.N2ND_ITM_GRP_CD
    </select>

    <!--공통-->
    <statement id="ProcS1145_1" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="int">
      declare @RTN VARCHAR(MAX)
      exec @RTN = sp_sale_insert_price #CHNL_CD#, #FM_DT#, #CRE_USR_ID#
      select @RTN AS R_value
    </statement>
    <!--공통-->
    <insert id="S1145InsertMst_1" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_ITM_PRC_IF
      (
      CHNL_CD
      , ITM_CD
      , ITM_PRC
      ) VALUES (
      #CHNL_CD#
      , #ITM_CD#
      , #ITM_PRC#
      )
    </insert>

    <!--사업장-->
    <statement id="ProcS1145_2" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="int">
      declare @RTN VARCHAR(MAX)
      exec @RTN = sp_sale_insert_area_price #CHNL_CD#, #FM_DT#, #CRE_USR_ID#
      select @RTN AS R_value
    </statement>
    <!--사업장-->
    <insert id="S1145InsertMst_2" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_ITM_PRC_AREA_IF
      (
      CHNL_CD
      , AREA_CD
      , ITM_CD
      , ITM_PRC
      ) VALUES (
      #CHNL_CD#
      , #AREA_CD#
      , #ITM_CD#
      , #ITM_PRC#
      )
    </insert>
    <!--이력관리-->
    <select id="S1145SelectViewList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT  CONVERT(VARCHAR, T1.ST_APLY_DT, 23)  AS ST_APLY_DT
      , CONVERT(VARCHAR, T1.END_APLY_DT, 23)  AS END_APLY_DT
      , T1.ITM_CD
      , T2.ITM_NM
      , T2.ITM_SZ_NM
      , T1.ITM_PRC
      , T1.CRE_USR_ID
      , CONVERT(VARCHAR, T1.CRE_DT, 23)  AS CRE_DT
      FROM TB_CD_SLPRC  T1
      , TB_CD_ITM    T2
      WHERE 1 = 1
      AND T1.ITM_CD   = T2.ITM_CD
      AND T1.CHNL_CD  = T2.CHNL_CD
      AND T1.CHNL_CD  = #CHNL_CD#
      AND T1.AREA_CD  = #AREA_CD#
      AND T1.ITM_CD   = #ITM_CD#
      ORDER BY T1.ITM_CD
    </select>
    <!-- 제품 단가 등록 -->
    
    
    <!-- 제품단가등록(내부2) -->
    <select id="S1146SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
          dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-002', T1.AREA_CD) AS AREA_NM
        , T1.AREA_CD
        , T1.ITM_CD
        , T2.ITM_NM
        , T2.ITM_SZ_NM
        , CONVERT(VARCHAR, T1.ST_APLY_DT, 23) AS ST_APLY_DT
        , CONVERT(VARCHAR, T1.END_APLY_DT, 23) AS END_APLY_DT
        , T1.ITM_PRC
        , T2.ITM_GRP_CLSS_CD
        , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'L-001', T2.ITM_GRP_CLSS_CD) AS ITM_GRP_CLSS_NM
        , T2.N1ST_ITM_GRP_CD
        , dbo.PUR_N1ST_GRP_NM_FNC(T1.CHNL_CD, T2.ITM_GRP_CLSS_CD,  T2.N1ST_ITM_GRP_CD) AS  N1ST_ITM_GRP_NM
        , T2.N2ND_ITM_GRP_CD
        , dbo.PUR_N2ST_GRP_NM_FNC(T1.CHNL_CD, T2.ITM_GRP_CLSS_CD,  T2.N1ST_ITM_GRP_CD, T2.N2ND_ITM_GRP_CD) AS N2ND_ITM_GRP_NM
        , CONVERT(VARCHAR, T1.ST_APLY_DT, 23) + '~' + CONVERT(VARCHAR, T1.END_APLY_DT, 23) AS TIT_DESC
        , T1.CHNL_CD
      FROM TB_CD_OTSR_PRC  T1
      ,  TB_CD_ITM    T2
      WHERE 1 = 1
        AND T1.ITM_CD       = T2.ITM_CD
        AND T1.CHNL_CD      = T2.CHNL_CD
        AND T1.AREA_CD      = #AREA_CD#
        AND T1.CHNL_CD      = #CHNL_CD#
      <isNotNull property="FM_DT">
        AND T1.ST_APLY_DT   <![CDATA[<=]]> CAST(CONVERT(VARCHAR, #FM_DT#, 112) + ' 23:59:59' AS DATETIME)
        AND T1.END_APLY_DT  >= CAST(CONVERT(VARCHAR, #FM_DT#, 112) + ' 23:59:59' AS DATETIME)
      </isNotNull>
      <isNotNull property="ITM_GRP_CLSS_CD">
        AND T2.ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
      </isNotNull>
      <isNotNull property="N1ST_ITM_GRP_CD">
        AND T2.N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
      </isNotNull>
      <isNotNull property="ITM_CD">
        AND T1.ITM_CD          = #ITM_CD#
      </isNotNull>
      <isNotNull property="ST_APLY_DT">
        AND CONVERT(VARCHAR, T1.ST_APLY_DT, 23)   = #ST_APLY_DT#
      </isNotNull>
      <isNotNull property="END_APLY_DT">
        AND CONVERT(VARCHAR, T1.END_APLY_DT, 23)  = #END_APLY_DT#
      </isNotNull>
      <!--AND T2.N2ND_ITM_GRP_CD = #N2ND_ITM_GRP_CD#-->
      ORDER BY T2.ITM_GRP_CLSS_CD, T2.N1ST_ITM_GRP_CD, T2.N2ND_ITM_GRP_CD
    </select>
    
    <insert id="S1146Insert" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_OTSR_PRC
      (
          CHNL_CD
        , AREA_CD
        , ST_APLY_DT
        , END_APLY_DT
        , ITM_CD
        , ITM_PRC
        , CRE_USR_ID
        , CRE_DT
        , UPD_USR_ID
        , UPD_DT
      )
      VALUES
      (
          #CHNL_CD#
        , #AREA_CD#
        , #ST_APLY_DT#
        , #END_APLY_DT#
        , #ITM_CD#
        , #ITM_PRC#
        , #CRE_USR_ID#
        , GETDATE()
        , #UPD_USR_ID#
        , GETDATE()
      )

    </insert>

    <update id="S1146Update" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_CD_OTSR_PRC
        SET ITM_PRC     = #ITM_PRC#
          , UPD_USR_ID  = #UPD_USR_ID#
          , UPD_DT      = GETDATE()
      WHERE 1 = 1
        AND CHNL_CD     = #CHNL_CD#
        AND AREA_CD     = #AREA_CD#
        AND ST_APLY_DT  = #ST_APLY_DT#
        AND END_APLY_DT = #END_APLY_DT#
        AND ITM_CD      = #ITM_CD#
    </update>

    <delete id="S1146Delete" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_CD_OTSR_PRC
        WHERE 1 = 1
          AND CHNL_CD     = #CHNL_CD#
          AND AREA_CD     = #AREA_CD#
          AND ST_APLY_DT  = #ST_APLY_DT#
          AND END_APLY_DT = #END_APLY_DT#
          AND ITM_CD      = #ITM_CD#
    </delete>
    

    <!-- 사업장창고관리 -->
    <!-- S1147 사업장창고관리 조회 -->
    <select id="S1147SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT AREA_CD
        , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'L-002', AREA_CD)  AS AREA_NM
        , LOC_CD
        , LOC_NM
        , LOC_RMK
        , CRE_USR_ID
        , UPD_USR_ID
        , CHNL_CD
      FROM TB_INVT_LOC
        WHERE 1 = 1
          AND CHNL_CD = #CHNL_CD#
          AND AREA_CD = #AREA_CD#
    </select>

    <!-- S1147 사업장창고관리 추가 -->
    <insert id="S1147Insert" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_INVT_LOC
      (
      CHNL_CD
      , AREA_CD
      , LOC_CD
      , LOC_NM
      , LOC_RMK
      , CRE_USR_ID
      , CRE_DT
      , UPD_USR_ID
      , UPD_DT
      )
      VALUES
      (
      #CHNL_CD#
      , #AREA_CD#
      , #LOC_CD#
      , #LOC_NM#
      , #LOC_RMK#
      , #CRE_USR_ID#
      , GETDATE()
      , #UPD_USR_ID#
      , GETDATE()
      )
    </insert>

    <!-- S1147 사업장창고관리 수정 -->
    <update id="S1147Update" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_INVT_LOC
      SET LOC_NM    = #LOC_NM#
      , LOC_RMK     = #LOC_RMK#
      , UPD_USR_ID  = #UPD_USR_ID#
      , UPD_DT      = GETDATE()
      WHERE 1 = 1
      AND CHNL_CD   = #CHNL_CD#
      AND AREA_CD   = #AREA_CD#
      AND LOC_CD    = #LOC_CD#
    </update>

    <delete id="S1147Delete" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_INVT_LOC
      WHERE 1 = 1
        AND CHNL_CD = #CHNL_CD#
        AND AREA_CD = #AREA_CD#
        AND LOC_CD  = #LOC_CD#
    </delete>
    <!-- 사업장창고관리 -->



    <!-- 창고 위치 관리 -->
    <select id="S1144SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT ITM_GRP_CLSS_NM
        , N1ST_ITM_GRP_NM
        , N2ND_ITM_GRP_NM
        , ITM_CD
        , ITM_NM
        , ITM_SZ_NM
        , AREA_CD
        , MAX(CASE WHEN RN = 1 THEN LOC_NM END) AS N1ST_LOC_NM
        , MAX(CASE WHEN RN = 2 THEN LOC_NM END) AS N2ND_LOC_NM
        , MAX(CASE WHEN RN = 3 THEN LOC_NM END) AS N3RD_LOC_NM
        , MAX(CASE WHEN RN = 4 THEN LOC_NM END) AS N4TH_LOC_NM
        , MAX(CASE WHEN RN = 5 THEN LOC_NM END) AS N5TH_LOC_NM
        , MAX(T1.ITM_STK_QTY) AS ITM_STK_QTY
        , CHNL_CD
      FROM (
        SELECT ROW_NUMBER() OVER (PARTITION BY T1.ITM_CD ORDER BY T2.LOC_SEQ) AS RN
          , T1.ITM_GRP_CLSS_CD
          , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'L-001', T1.ITM_GRP_CLSS_CD) AS ITM_GRP_CLSS_NM
          , T1.N1ST_ITM_GRP_CD
          , dbo.PUR_N1ST_GRP_NM_FNC(#CHNL_CD#, T1.ITM_GRP_CLSS_CD, T1.N1ST_ITM_GRP_CD) AS N1ST_ITM_GRP_NM
          , T1.N2ND_ITM_GRP_CD
          , dbo.PUR_N2ST_GRP_NM_FNC(#CHNL_CD#, T1.ITM_GRP_CLSS_CD, T1.N1ST_ITM_GRP_CD, T1.N2ND_ITM_GRP_CD) AS N2ND_ITM_GRP_NM
          , T1.ITM_CD
          , T1.ITM_NM
          , T1.ITM_SZ_NM
          , T2.LOC_NM
          , T2.AREA_CD
          , dbo.FF_ITM_STK_QTY(#CHNL_CD#, #AREA_CD#, T1.ITM_CD, GETDATE())  AS ITM_STK_QTY
          , T1.CHNL_CD
        FROM TB_CD_ITM T1 LEFT OUTER JOIN TB_CD_ITM_LOC T2 ON (T1.ITM_CD = T2.ITM_CD 
          AND T1.CHNL_CD = T2.CHNL_CD
        <isNotNull property="AREA_CD">
          AND T2.AREA_CD = #AREA_CD#
        </isNotNull>
      )
      WHERE 1 = 1
          AND T1.CHNL_CD = #CHNL_CD#
        <isNotNull property="ITM_GRP_CLSS_CD">
          AND ITM_GRP_CLSS_CD = #ITM_GRP_CLSS_CD#
        </isNotNull>
        <isNotNull property="N1ST_ITM_GRP_CD">
          AND N1ST_ITM_GRP_CD = #N1ST_ITM_GRP_CD#
        </isNotNull>
      ) T1
      GROUP BY ITM_GRP_CLSS_NM
        , N1ST_ITM_GRP_NM
        , N2ND_ITM_GRP_NM
        , ITM_CD
        , ITM_NM
        , ITM_SZ_NM
        , AREA_CD
        , RN
        , CHNL_CD
      ORDER BY RN
    </select>


    <insert id="S1144InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_LOC
      (
          CHNL_CD
        , AREA_CD
        , ITM_CD
        , LOC_SEQ
        , N1ST_LOC_ID
        , N2ND_LOC_ID
        , N3RD_LOC_ID
        , LOC_NM
        , CRE_USR_ID
        , CRE_DT
        , UPD_USR_ID
        , UPD_DT
      ) 
      VALUES
      (
          #CHNL_CD#
        , #AREA_CD#
        , #ITM_CD#
        , (SELECT ISNULL(MAX(LOC_SEQ), 0) + 1 FROM TB_CD_ITM_LOC WHERE 1 = 1 AND CHNL_CD  = #CHNL_CD# AND AREA_CD  = #AREA_CD# AND ITM_CD   = #ITM_CD# )
        , #N1ST_LOC_ID#
        , #N2ND_LOC_ID#
        , #N3RD_LOC_ID#
        , #LOC_NM#
        , #CRE_USR_ID#
        , GETDATE()
        , #UPD_USR_ID#
        , GETDATE()
      )
    </insert>

    <update id="S1144UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_CD_ITM_LOC
        SET  N1ST_LOC_ID   = #N1ST_LOC_ID#
          , N2ND_LOC_ID   = #N2ND_LOC_ID#
          , N3RD_LOC_ID   = #N3RD_LOC_ID#
          , LOC_NM        = #LOC_NM#
          , UPD_USR_ID    = #UPD_USR_ID#
          , UPD_DT        = GETDATE()
      WHERE 1 = 1
        AND CHNL_CD    = #CHNL_CD#
        AND AREA_CD    = #AREA_CD#
        AND ITM_CD     = #ITM_CD#
        AND LOC_SEQ    = #LOC_SEQ#
    </update>

    <delete id="S1144DeleteMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_CD_ITM_LOC
        WHERE 1 = 1
          AND CHNL_CD    = #CHNL_CD#
          AND AREA_CD    = #AREA_CD#
          AND ITM_CD     = #ITM_CD#
        <isNotNull property="LOC_SEQ">
          AND LOC_SEQ    = #LOC_SEQ#
        </isNotNull>
    </delete>


    <select id="S1144SelectDtlList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT LOC_SEQ
        , N1ST_LOC_ID
        , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#,'C-006', N1ST_LOC_ID) AS N1ST_LOC_NM
        , N2ND_LOC_ID
        , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#,'C-007', N2ND_LOC_ID)	AS N2ND_LOC_NM
        , N3RD_LOC_ID
        , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#,'C-008', N3RD_LOC_ID)	AS N3RD_LOC_NM
        , LOC_NM
        , CHNL_CD
      FROM TB_CD_ITM_LOC
        WHERE 1=1
          AND CHNL_CD = #CHNL_CD#
        <isNotNull property="AREA_CD">
          AND AREA_CD  = #AREA_CD#
        </isNotNull>
          AND ITM_CD    = #ITM_CD#
    </select>


    <!-- 창고 위치 이력관리 조회 -->
    <select id="S1144SelectHistList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT T1.ITM_CD
        , T2.ITM_NM
        , T2.ITM_SZ_NM
        , T1.LOC_NM
        , dbo.USR_NM_FNC(#CHNL_CD#, T1.CRE_USR_ID)  AS USR_ID
        , CONVERT(VARCHAR, T1.CRE_DT, 121)  AS CRE_DT
        , T1.CHNL_CD
      FROM TB_CD_ITM_LOC_HIST  T1
          , TB_CD_ITM           T2
      WHERE 1 = 1
        AND T1.CHNL_CD   = T2.CHNL_CD
        AND T1.ITM_CD    = T2.ITM_CD
        AND T1.CHNL_CD   = #CHNL_CD#
        AND T1.CRE_DT    >= CAST(#FM_DT# + ' 00:00:00' AS DATETIME)
        AND T1.CRE_DT    <![CDATA[<=]]> CAST(#TO_DT# + ' 23:59:59' AS DATETIME)
        AND T1.AREA_CD   = #AREA_CD#
        <isNotNull property="ITM_CD">
          AND T1.ITM_CD    = #ITM_CD#
        </isNotNull>
      ORDER BY T1.CRE_DT DESC
    </select>

    <insert id="S1144UpdateMstHistory" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_LOC_HIST 
      (
          CHNL_CD
        , AREA_CD
        , ITM_CD
        , CRE_DT
        , LOC_SEQ
        , N1ST_LOC_ID
        , N2ND_LOC_ID
        , N3RD_LOC_ID
        , LOC_NM
        , CRE_USR_ID
        , LOC_DESC
        , UPD_VAL
      )
      SELECT 
          CHNL_CD
        , AREA_CD
        , ITM_CD
        , GETDATE()
        , LOC_SEQ
        , N1ST_LOC_ID
        , N2ND_LOC_ID
        , N3RD_LOC_ID
        , LOC_NM
        , CRE_USR_ID
        , LOC_DESC
        , 'U'
      FROM TB_CD_ITM_LOC
        WHERE 1 = 1
          AND CHNL_CD  = #CHNL_CD#
          AND AREA_CD  = #AREA_CD#
          AND ITM_CD   = #ITM_CD#
      <isNotNull property="LOC_SEQ">
          AND LOC_SEQ  = #LOC_SEQ#
      </isNotNull>
    </insert>

    <insert id="S1144DeleteMstHistory" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_LOC_HIST 
      (
          CHNL_CD
        , AREA_CD
        , ITM_CD
        , CRE_DT
        , LOC_SEQ
        , N1ST_LOC_ID
        , N2ND_LOC_ID
        , N3RD_LOC_ID
        , LOC_NM
        , CRE_USR_ID
        , LOC_DESC
        , UPD_VAL
      )
        SELECT 
            CHNL_CD
          , AREA_CD
          , ITM_CD
          , GETDATE()
          , LOC_SEQ
          , N1ST_LOC_ID
          , N2ND_LOC_ID
          , N3RD_LOC_ID
          , LOC_NM
          , CRE_USR_ID
          , LOC_DESC
          , 'D'
        FROM TB_CD_ITM_LOC
          WHERE 1 = 1
            AND CHNL_CD  = #CHNL_CD#
            AND AREA_CD  = #AREA_CD#
            AND ITM_CD   = #ITM_CD#
        <isNotNull property="LOC_SEQ">
            AND LOC_SEQ  = #LOC_SEQ#
        </isNotNull>
    </insert>

    <!-- 창고 위치 관리 -->
    
    <!-- 금형 위치 이력관리 조회 -->
    <select id="M6663SelectHistList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT  T2.MOLD_NO AS ITM_CD
        , T2.MOLD_SZ AS ITM_NM
        , T2.ITM_CD AS ITM_SZ_NM
        , T1.LOC_NM
        , dbo.USR_NM_FNC(#CHNL_CD#, T1.CRE_USR_ID)  AS USR_ID
        , CONVERT(VARCHAR, T1.CRE_DT, 121)  AS CRE_DT
        , T1.CHNL_CD
      FROM TB_CD_ITM_LOC_HIST  T1
          , TB_PROD_MOLD_CD           T2
      WHERE 1 = 1
        AND T1.CHNL_CD   = T2.CHNL_CD
        AND T1.ITM_CD    = T2.MOLD_NO
        AND T1.CHNL_CD   = #CHNL_CD#
        AND T1.CRE_DT    >= CAST(#FM_DT# + ' 00:00:00' AS DATETIME)
        AND T1.CRE_DT    <![CDATA[<=]]> CAST(#TO_DT# + ' 23:59:59' AS DATETIME)
        AND T1.AREA_CD   = #AREA_CD#
        <isNotNull property="ITM_CD">
          AND T1.ITM_CD    = #ITM_CD#
        </isNotNull>
      ORDER BY T1.CRE_DT DESC
    </select>
    
    

    
    <!-- 로그인 현황 -->
    <select id="S11315SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
		SELECT
		        T1.PGM_CLSS_CD
		      , T1.PGM_CLSS_NM
		      , T1.LGIN_USR_NM
		      , T1.LGIN_USR_ID
	    	  , MIN(LGIN_ST_DT)     AS LGIN_ST_DT
		      , MAX(LGIN_END_DT)    AS LGIN_END_DT
		      , ABS(SUM(LGIN_MM)) AS LGIN_MM
		      , COUNT(*)            AS LGIN_CNT
		FROM
		(
		    SELECT
		          CHNL_CD
		        , PGM_CLSS_CD
		        , (CASE WHEN PGM_CLSS_CD = 'A' THEN  'ERP' WHEN PGM_CLSS_CD = 'B' THEN 'MES' ELSE '' END) AS PGM_CLSS_NM
		        , dbo.USR_NM_FNC(#CHNL_CD#, LGIN_USR_ID) AS LGIN_USR_NM
		        , LGIN_USR_ID
		        , CONVERT(VARCHAR, LGIN_ST_DT, 120) AS LGIN_ST_DT
		        , CONVERT(VARCHAR, LGIN_END_DT, 120) AS LGIN_END_DT
		        , LGIN_GUID
		        , ISNULL(DATEDIFF(mi,LGIN_ST_DT, LGIN_END_DT),0) AS LGIN_MM
		    FROM TB_SYS_USR_LGIN
		        WHERE 1=1
		            AND CHNL_CD = #CHNL_CD#
		            AND CONVERT(DATE, LGIN_ST_DT) >= CAST(#FM_DT# + ' 00:00:00' AS DATETIME)
		            AND CONVERT(DATE, LGIN_END_DT) <![CDATA[<=]]>  CAST(#TO_DT# + ' 23:59:59' AS DATETIME)
		) AS T1
		GROUP BY T1.PGM_CLSS_CD, T1.PGM_CLSS_NM, T1.LGIN_USR_NM, T1.LGIN_USR_ID
		<!--SELECT  
            CHNL_CD
          , PGM_CLSS_CD
          , (CASE WHEN PGM_CLSS_CD = 'A' THEN  'ERP'	WHEN PGM_CLSS_CD = 'B' THEN 'MES'	ELSE '' END) AS PGM_CLSS_NM 
          , dbo.USR_NM_FNC(#CHNL_CD#, LGIN_USR_ID) AS LGIN_USR_NM
          , LGIN_USR_ID
          , CONVERT(VARCHAR, LGIN_ST_DT, 120) AS LGIN_ST_DT
          , CONVERT(VARCHAR, LGIN_END_DT, 120) AS LGIN_END_DT
          , LGIN_GUID
        FROM TB_SYS_USR_LGIN
          WHERE 1=1 
            AND CHNL_CD = #CHNL_CD#
          ORDER BY LGIN_END_DT DESC-->
    </select>
    
    <insert id="S11315InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_USR_LGIN
      (
          CHNL_CD
        , PGM_CLSS_CD
        , LGIN_USR_ID
        , LGIN_ST_DT
        , LGIN_END_DT
        , LGIN_GUID
      )
      VALUES
      (
          #CHNL_CD#
        , #PGM_CLSS_CD#
        , #LGIN_USR_ID#
        , GETDATE()
        , #LGIN_END_DT#
        , #LGIN_GUID#
      )
    </insert>

    <update id="S11315UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_SYS_USR_LGIN
            SET LGIN_END_DT = GETDATE()
         WHERE 1 = 1
            AND CHNL_CD      = #CHNL_CD#
            AND PGM_CLSS_CD  = #PGM_CLSS_CD#
            AND LGIN_GUID    = #LGIN_GUID#
    </update>
    <!-- 로그인 현황 -->

    
    <!-- 근태기준정보관리 -->  
     <select id="S1161SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
        SELECT  
            ROW_NUMBER() OVER (PARTITION BY CHNL_CD ORDER BY WRK_TP_CD) AS RN
          , CHNL_CD
          , WRK_TP_CD
          , WRK_TP_NM
          , ST_HR_MNT
          , END_HR_MNT
          , WRK_TP_VAL
        FROM TB_SYS_WRK_TP_SKD
          WHERE 1=1 
            AND CHNL_CD = #CHNL_CD#
      </select>
    
     <insert id="S1161InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_WRK_TP_SKD
      (
          CHNL_CD
        , WRK_TP_CD
        , WRK_TP_NM
        , ST_HR_MNT
        , END_HR_MNT
        , WRK_TP_VAL
      )
      VALUES
      (
          #CHNL_CD#
        , #WRK_TP_CD#
        , #WRK_TP_NM#
        , #ST_HR_MNT#
        , #END_HR_MNT#
        , #WRK_TP_VAL#
      )
    </insert>
    <update id="S1161UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_SYS_WRK_TP_SKD
        SET
            WRK_TP_CD = #WRK_TP_CD#
          , WRK_TP_NM = #WRK_TP_NM#
          , ST_HR_MNT = #ST_HR_MNT#
          , END_HR_MNT = #END_HR_MNT#
          , WRK_TP_VAL = #WRK_TP_VAL#
        WHERE CHNL_CD     = #CHNL_CD#
          AND WRK_TP_CD   = #WRK_TP_CD#
    </update>
    <!-- 근태기준정보관리 -->
    
    <!-- 근무보고서 -->  
      <select id="S1162SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
       SELECT  
            ROW_NUMBER() OVER (PARTITION BY T1.CHNL_CD ORDER BY T1.WRK_DT) AS RN
          , T1.CHNL_CD
          , T1.EMPE_ID
          , T2.GRP_ID
          , ISNULL((SELECT GRP_NM FROM TB_SYS_GRP AS A WHERE 1=1 AND A.CHNL_CD = T2.CHNL_CD AND A.GRP_ID = T2.GRP_ID), '')  AS GRP_NM
          , T2.USR_N1ST_NM
          , T1.WRK_GRP_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'HR-001', T1.WRK_GRP_CD) AS WRK_GRP_NM
          , CONVERT(VARCHAR(10), CONVERT(DATE, T1.WRK_DT), 23) AS WRK_DT
          , T1.WRK_RSN_CD
          , dbo.CD_SYS_CLSS_FNC(T1.CHNL_CD, 'HR-002', T1.WRK_RSN_CD) AS WRK_RSN_NM
          , ISNULL(T1.ERY_WRK_FLG, 0) AS ERY_WRK_FLG
          , ISNULL(T1.XTD_WRK_FLG, 0) AS XTD_WRK_FLG
          , ISNULL(T1.NGT_WRK_FLG, 0) AS NGT_WRK_FLG
          <!--
          , CASE WHEN ISNULL(T1.ERY_WRK_FLG, 'N') = 'Y' THEN 1 ELSE 0 END AS ERY_WRK_FLG
          , CASE WHEN ISNULL(T1.XTD_WRK_FLG, 'N') = 'Y' THEN 1 ELSE 0 END AS XTD_WRK_FLG
          -->
          , T1.ST_TM_NO
          , T1.END_TM_NO
          , T1.N1ST_TM_VAL
          , T1.N2ND_TM_VAL
          , T1.N3RD_TM_VAL
          , T1.N4TH_TM_VAL
          , (T1.N1ST_TM_VAL + T1.N2ND_TM_VAL + T1.N3RD_TM_VAL + T1.N4TH_TM_VAL) AS TTL_TM_VAL
        FROM TB_SYS_WRK_RPT AS T1
           , TB_SYS_USR     AS T2
        WHERE 1=1
          AND T1.CHNL_CD    = T2.CHNL_CD
          AND T1.EMPE_ID    = T2.USR_ID
          AND T1.CHNL_CD    = #CHNL_CD#
          AND T2.TM_PAY_FLG = 'Y'
          AND CONVERT(DATE, T1.WRK_DT) >= CAST(#FM_DT# + ' 00:00:00' AS DATETIME)
          AND CONVERT(DATE, T1.WRK_DT) <![CDATA[<=]]> CAST(#TO_DT# + ' 23:59:59' AS DATETIME)
        <isNotNull property="A_WRK_RSN_CD">
          <iterate property="A_WRK_RSN_CD" prepend=" AND T1.WRK_RSN_CD  IN " open="(" close =")" conjunction=","  >
              #A_WRK_RSN_CD[]#
          </iterate>
        </isNotNull>
    
      </select>

     <insert id="S1162InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
     INSERT INTO TB_SYS_WRK_RPT
      (
           CHNL_CD
         , EMPE_ID
         , WRK_GRP_CD
         , WRK_DT
         , WRK_RSN_CD
         , ERY_WRK_FLG
         , XTD_WRK_FLG
         , NGT_WRK_FLG
         , ST_TM_NO
         , END_TM_NO
         , N1ST_TM_VAL
         , N2ND_TM_VAL
         , N3RD_TM_VAL
         , N4TH_TM_VAL
         , CRE_USR_ID
         , CRE_DT
         , UPD_USR_ID
         , UPD_DT
      )
      VALUES
      (
          #CHNL_CD#
        , #EMPE_ID#
        , #WRK_GRP_CD#
        , #WRK_DT#
        , #WRK_RSN_CD#
        , #ERY_WRK_FLG#
        , #XTD_WRK_FLG#
        , #NGT_WRK_FLG#
        , #ST_TM_NO#
        , #END_TM_NO#
        , #N1ST_TM_VAL#
        , #N2ND_TM_VAL#
        , #N3RD_TM_VAL#
        , #N4TH_TM_VAL#
        , #CRE_USR_ID#
        , GETDATE()
        , #UPD_USR_ID#
        , GETDATE()
      )
    </insert>
    
    <update id="S1162UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
     UPDATE TB_SYS_WRK_RPT 
      SET
          EMPE_ID     = #EMPE_ID#
        , WRK_GRP_CD  = #WRK_GRP_CD#
        , WRK_DT      = #WRK_DT#
        , WRK_RSN_CD  = #WRK_RSN_CD#
        , ERY_WRK_FLG = #ERY_WRK_FLG#
        , XTD_WRK_FLG = #XTD_WRK_FLG#
        , NGT_WRK_FLG = #NGT_WRK_FLG#
        , ST_TM_NO    = #ST_TM_NO#
        , END_TM_NO   = #END_TM_NO#
        , N1ST_TM_VAL = #N1ST_TM_VAL#
        , N2ND_TM_VAL = #N2ND_TM_VAL#
        , N3RD_TM_VAL = #N3RD_TM_VAL#
        , N4TH_TM_VAL = #N4TH_TM_VAL#
        , UPD_USR_ID  = #UPD_USR_ID#
        , UPD_DT      = GETDATE() 
      WHERE CHNL_CD                                          = #CHNL_CD#
        AND EMPE_ID                                          = #EMPE_ID#
        AND WRK_GRP_CD                                       = #WRK_GRP_CD#
        AND CONVERT(VARCHAR(10), CONVERT(DATE, WRK_DT), 23)  = #WRK_DT#
    </update>
  
    <delete id="S1162DeleteMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE FROM TB_SYS_WRK_RPT
        WHERE 1 = 1
          AND CHNL_CD                                         = #CHNL_CD#
          AND EMPE_ID                                         = #EMPE_ID#
          AND WRK_GRP_CD                                      = #WRK_GRP_CD#
          AND CONVERT(VARCHAR(10), CONVERT(DATE, WRK_DT), 23) = #WRK_DT#
    </delete>
    
    <!-- 근무보고서 -->



	<!-- 보고서 관리 -->
	<select id="S1412SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
		SELECT 
		    CHNL_CD
		  , RPT_CD
		  , RPT_NM
		  , RPT_FILE 
		  , RPT_FLG
		FROM TB_CD_RPT
		WHERE 1=1 
		  AND CHNL_CD = #CHNL_CD#
		  <isNotNull property="RPT_CD">
		  AND RPT_CD = #RPT_CD#
		  </isNotNull>
		  <isNotNull property="RPT_FLG">
			AND RPT_FLG = #RPT_FLG#
		  </isNotNull>
	</select>

	  <insert id="S1412InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		  INSERT INTO TB_CD_RPT
		  (
		    CHNL_CD
		  , RPT_CD
		  , RPT_NM
		  , RPT_FILE
		  , CRE_USR_ID
		  , CRE_DT
		  , UPD_USR_ID
		  , UPD_DT
		  , RPT_FLG
		  )
		  VALUES
		  (
		    #CHNL_CD#
		  , #RPT_CD#
		  , #RPT_NM#
		  , #RPT_FILE#
		  , #CRE_USR_ID#
		  , GETDATE()
		  , #UPD_USR_ID#
		  , GETDATE()
		  , #RPT_FLG#
		  )
	  </insert>

	  <update id="S1412UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		  UPDATE TB_CD_RPT
		  SET
		        RPT_NM      = #RPT_NM#
		      , RPT_FILE    = #RPT_FILE#
		      , UPD_USR_ID  = #UPD_USR_ID#
		      , UPD_DT      = GETDATE()
		  WHERE 1=1
		    AND CHNL_CD = #CHNL_CD#
			AND RPT_CD = #RPT_CD#
			AND RPT_FLG = #RPT_FLG#
	  </update>

	  <delete id="S1412DeleteMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		  DELETE FROM TB_CD_RPT
		  WHERE 1 = 1
		    AND CHNL_CD = #CHNL_CD#
			AND RPT_CD = #RPT_CD#
			AND RPT_FLG = #RPT_FLG#
	  </delete>
	  
	  
	  
	  <!-- 완제품코드등록	 -->  
    <select id="S14130SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT              
              T6.CO_NM                  
            , T1.CAR_ITM_NM             
            , T2.MDL_NM                 
            , T2.CAR_TP_CD                 
            , T1.ITM_CD                 
            , T1.ITM_NM                 
            , T3.N2ND_SUB_ITM_CD        
            , T3.N2ND_SUB_ITM_NM        
            , T1.ITM_SZ_NM              
            , T5.UOM_NM                 
            , T4.ITM_GRP_NM 
            , T4.ITM_GRP_CD 
            , CONVERT(VARCHAR, T1.CRE_DT, 23) AS CRE_DT
            , T1.ITM_DESC
            , T1.DELT_FLG
            , T1.ITM_TMP_NM
            , T1.ITM_SZ_NM
        FROM TB_CD_ITM T1
        OUTER APPLY 
        ( 
            SELECT X.CAR_TP_NM         AS MDL_NM
                ,  X.CAR_TP_CD         AS CAR_TP_CD
              FROM TB_CD_CAR_TP X
             WHERE 1 = 1 
               AND X.CHNL_CD = #CHNL_CD#
               AND X.CAR_TP_CD = T1.CAR_ITM_NM
         )T2
        OUTER APPLY
        (
            SELECT  X.CLSS_DESC          AS N2ND_SUB_ITM_NM
                  , X.CLSS_CD            AS N2ND_SUB_ITM_CD
              FROM TB_SYS_CLSS_CD X
             WHERE 1 = 1
               AND X.CHNL_CD = #CHNL_CD#
               AND X.CLSS_TP_CD = 'L-800'
               AND X.CLSS_CD = T1.N2ND_SUB_ITM_CD
        )T3
        OUTER APPLY
        (
            SELECT X.ITM_GRP_NM             AS ITM_GRP_NM
                 , X.ITM_GRP_CD             AS ITM_GRP_CD
              FROM TB_CD_ITM_GRP X
             WHERE 1 = 1 
               AND X.CHNL_CD = #CHNL_CD#
               AND X.ITM_GRP_CD = T1.N1ST_ITM_GRP_CD
               AND X.ITM_GRP_CLSS_CD ='G'
        )T4
        OUTER APPLY
        (
            SELECT X.CLSS_DESC          AS UOM_NM
              FROM TB_SYS_CLSS_CD X 
             WHERE 1 = 1 
               AND X.CHNL_CD = #CHNL_CD#
               AND X.CLSS_TP_CD = 'L-003'
               AND X.CLSS_CD    =  T1.UOM_CD
        )T5
        OUTER APPLY
        (
            SELECT X.CO_NM              AS CO_NM
              FROM TB_CD_CO X
             WHERE 1 = 1 
               AND X.CHNL_CD = #CHNL_CD#
               AND X.CO_NO = T1.CO_NO
        )T6
        WHERE 1 = 1 
          AND T1.CHNL_CD          = #CHNL_CD#
          AND T1.ITM_GRP_CLSS_CD  = 'G'
          AND T1.CRE_DT           >= CAST(#FM_DT# + ' 00:00:00' AS DATETIME)
          AND T1.CRE_DT         <![CDATA[ <= ]]> CAST(#TO_DT# + ' 23:59:59' AS DATETIME)
    
      </select>
	  
	    <insert id="S14130InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		    INSERT INTO TB_CD_ITM
        ( 
             CHNL_CD
           , PROD_LOC_CD
           , CO_NO
           , CAR_ITM_NM
           , N2ND_SUB_ITM_CD
           , N1ST_ITM_GRP_CD
           , ITM_TMP_NM 
           , ITM_SZ_NM
           , ITM_NM
           , ITM_CD
           , ITM_DESC
           , UOM_CD
           , ITM_GRP_CLSS_CD
           , CRE_USR_ID
           , CRE_DT
           , UPD_USR_ID
           , UPD_DT
           , DELT_FLG
        )
        VALUES 
        (
             #CHNL_CD#
           , '001'
           , #CO_NO#
           , #CAR_TP_CD#
           , #N2ND_SUB_ITM_CD#
           , #N1ST_ITM_GRP_CD#
           , #ITM_TMP_NM#
           , #ITM_SZ_NM#
           , dbo.FF_CD_ITM_ANP_NM(#CHNL_CD#, #CAR_TP_CD#, #N1ST_ITM_GRP_CD#, #N1ST_ITM_GRP_NM#, #ITM_SZ_NM#, #ITM_TMP_NM#)
           , dbo.FF_CD_ITM_ANP_CD(#CO_NO#, #CAR_TP_CD#, #N2ND_SUB_ITM_CD#, #CHNL_CD#) 
           , #ITM_DESC#
           , #UOM_CD#
           , 'G'
           , #CRE_USR_ID#
           , GETDATE()
           , #UPD_USR_ID#
           , GETDATE()
           ,'N'
         )
 
	  </insert>

	  <update id="S14130UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		  UPDATE TB_CD_ITM
		    SET
               CO_NO            = #CO_NO#
             , CAR_ITM_NM       = #CAR_TP_CD#
             , N2ND_SUB_ITM_CD  = #N2ND_SUB_ITM_CD#
             , N1ST_ITM_GRP_CD  = #N1ST_ITM_GRP_CD#
             , ITM_TMP_NM       = #ITM_TMP_NM#
             , ITM_SZ_NM        = #ITM_SZ_NM#
             , ITM_NM           = dbo.FF_CD_ITM_ANP_NM(#CHNL_CD#, #CAR_TP_CD#, #N1ST_ITM_GRP_CD#, #N1ST_ITM_GRP_NM#, #ITM_SZ_NM#, #ITM_TMP_NM#)
             , ITM_CD           = dbo.FF_CD_ITM_ANP_CD(#CO_NO#, #N1ST_ITM_GRP_CD#, #N2ND_SUB_ITM_CD#, #CHNL_CD#)
             , ITM_DESC         = #ITM_DESC#
             , UOM_CD           = #UOM_CD#
             , UPD_USR_ID       = #UPD_USR_ID#
		         , UPD_DT           = GETDATE()
      WHERE 1=1
		    AND CHNL_CD = #CHNL_CD#
			  AND ITM_CD  = #ITM_CD#
	  </update>

	  <update id="S14130DeleteMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
		  UPDATE TB_CD_ITM
		    SET
               UPD_USR_ID       = #UPD_USR_ID#
		         , UPD_DT           = GETDATE()
		         , DELT_FLG         = #DELT_FLG#
      WHERE 1=1
		    AND CHNL_CD = #CHNL_CD#
			  AND ITM_CD  = #ITM_CD#
	  </update>



    <!-- 이형봉강 조견표 	 -->
    <select id="S1413SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT   
               ROW_NUMBER() OVER (PARTITION BY BAR_SZ_CD ORDER BY BAR_SZ_CD, GBN) AS RN 
	           , BAR_CLSS_CD
             , dbo.CD_SYS_CLSS_FNC(#CHNL_CD#, 'S-060', BAR_CLSS_CD) AS BAR_CLSS_NM
             , BAR_SZ_CD
             , BAR_UOM_WGT
             , ITM_NM       AS GBN
             , N1ST_LEN_CD  AS N1ST_LEN_VAL
             , N2ND_LEN_CD  AS N2ND_LEN_VAL
             , N3RD_LEN_CD  AS N3RD_LEN_VAL
             , N4TH_LEN_CD  AS N4TH_LEN_VAL
             , N5TH_LEN_CD  AS N5TH_LEN_VAL
             , N6TH_LEN_CD  AS N6TH_LEN_VAL
             , N7TH_LEN_CD  AS N7TH_LEN_VAL
             , N8TH_LEN_CD  AS N8TH_LEN_VAL
             , N9TH_LEN_CD  AS N9TH_LEN_VAL
        FROM (
                SELECT 'A' AS GBN 
			               , BAR_CLSS_CD
                     , '1본중량'  AS ITM_NM
                     , BAR_SZ_CD
                     , BAR_UOM_WGT
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6 THEN BAR_PER_WGT END), 0)      AS N1ST_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6.5 THEN BAR_PER_WGT END), 0)    AS N2ND_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7 THEN BAR_PER_WGT END), 0)      AS N3RD_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7.5 THEN BAR_PER_WGT END), 0)    AS N4TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 8 THEN BAR_PER_WGT END), 0)      AS N5TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 9 THEN BAR_PER_WGT END), 0)      AS N6TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 10 THEN BAR_PER_WGT END), 0)     AS N7TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 11 THEN BAR_PER_WGT END), 0)     AS N8TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 12 THEN BAR_PER_WGT END), 0)     AS N9TH_LEN_CD
                  FROM TB_CD_DEFM_BAR_MATH_TBL
                 WHERE 1 = 1
                   AND CHNL_CD     = #CHNL_CD#
                   AND BAR_CLSS_CD = #BAR_CLSS_CD#
                GROUP BY BAR_SZ_CD
                       , BAR_UOM_WGT  
				               , BAR_CLSS_CD
                UNION ALL
                SELECT 'B' AS GBN 
			               , BAR_CLSS_CD
                     , '총본수'
                     , BAR_SZ_CD
                     , BAR_UOM_WGT
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6 THEN BAR_QTY END), 0)      AS N1ST_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6.5 THEN BAR_QTY END), 0)    AS N2ND_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7 THEN BAR_QTY END), 0)      AS N3RD_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7.5 THEN BAR_QTY END), 0)    AS N4TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 8 THEN BAR_QTY END), 0)      AS N5TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 9 THEN BAR_QTY END), 0)      AS N6TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 10 THEN BAR_QTY END), 0)     AS N7TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 11 THEN BAR_QTY END), 0)     AS N8TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 12 THEN BAR_QTY END), 0)     AS N9TH_LEN_CD
                  FROM TB_CD_DEFM_BAR_MATH_TBL
                 WHERE 1 = 1
                   AND CHNL_CD     = #CHNL_CD#
                   AND BAR_CLSS_CD = #BAR_CLSS_CD#
                GROUP BY BAR_SZ_CD
                       , BAR_UOM_WGT   
				               , BAR_CLSS_CD
                UNION ALL
                SELECT 'C' 
			               , BAR_CLSS_CD
                     , '중  량'          
                     , BAR_SZ_CD
                     , BAR_UOM_WGT
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6 THEN BAR_WGT END), 0)      AS N1ST_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6.5 THEN BAR_WGT END), 0)    AS N2ND_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7 THEN BAR_WGT END), 0)      AS N3RD_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7.5 THEN BAR_WGT END), 0)    AS N4TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 8 THEN BAR_WGT END), 0)      AS N5TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 9 THEN BAR_WGT END), 0)      AS N6TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 10 THEN BAR_WGT END), 0)     AS N7TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 11 THEN BAR_WGT END), 0)     AS N8TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 12 THEN BAR_WGT END), 0)     AS N9TH_LEN_CD
                  FROM TB_CD_DEFM_BAR_MATH_TBL
                 WHERE 1 = 1
                   AND CHNL_CD     = #CHNL_CD#
                   AND BAR_CLSS_CD = #BAR_CLSS_CD#
                GROUP BY BAR_SZ_CD
                       , BAR_UOM_WGT     
				               , BAR_CLSS_CD
                UNION ALL
                SELECT 'D'
			               , BAR_CLSS_CD
                     , '총길이'                    
                     , BAR_SZ_CD
                     , BAR_UOM_WGT
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6 THEN  BAR_TTL_LEN END), 0)      AS N1ST_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 6.5 THEN BAR_TTL_LEN END), 0)    AS N2ND_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7 THEN BAR_TTL_LEN END), 0)      AS N3RD_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 7.5 THEN BAR_TTL_LEN END), 0)    AS N4TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 8 THEN BAR_TTL_LEN END), 0)      AS N5TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 9 THEN BAR_TTL_LEN END), 0)      AS N6TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 10 THEN BAR_TTL_LEN END), 0)     AS N7TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 11 THEN BAR_TTL_LEN END), 0)     AS N8TH_LEN_CD
                     , ISNULL(MAX(CASE WHEN BAR_SZ_LEN = 12 THEN BAR_TTL_LEN END), 0)     AS N9TH_LEN_CD
                  FROM TB_CD_DEFM_BAR_MATH_TBL
                 WHERE 1 = 1
                   AND CHNL_CD     = #CHNL_CD#
                   AND BAR_CLSS_CD = #BAR_CLSS_CD#
                GROUP BY BAR_SZ_CD
                       , BAR_UOM_WGT     
				               , BAR_CLSS_CD
          ) T1 
    </select>








    <!--메시지 보내기 관리-->
    <select id="S1134GetUsrSelectMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
      USR_ID
      , USR_N1ST_NM
      , OFC_PSN_CD
      , (SELECT TOP 1 CLSS_DESC  FROM TB_SYS_CLSS_CD WHERE 1=1 AND CHNL_CD = T1.CHNL_CD AND CLSS_TP_CD = 'G-001' AND CLSS_CD = T1.OFC_PSN_CD) AS OFC_PSN_NM
      , CELL_PHN_NO
      , GRP_ID
      , (SELECT TOP 1 GRP_NM  FROM TB_SYS_GRP WHERE 1=1 AND CHNL_CD = T1.CHNL_CD AND GRP_ID = T1.GRP_ID) AS GRP_NM
      FROM  TB_SYS_USR T1
      WHERE 1 = 1
      AND T1.CHNL_CD  = #CHNL_CD#
    </select>

    <select id="S1134SelectDate" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="string">
      SELECT CONVERT(VARCHAR,GETDATE(),21)
    </select>

    <insert id="S1134MailListInsert" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_MAIL_LIST
      (
      MSG_NO
      , TIT_MSG
      , WRITE_DT
      , WRITE_ID
      , CHNL_CD
      )
      VALUES
      (
      #MSG_NO#
      , #TIT_MSG#
      , GETDATE()
      , #WRITE_ID#
      , #CHNL_CD#
      )
    </insert>


    <insert id="S1134MailGetInsert" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_SYS_MAILBX
      (
      LGIN_ID
      , MSG_NO
      , ACPT_DT
      , CHNL_CD
      )
      VALUES
      (
      #LGIN_ID#
      , #MSG_NO#
      , #ACPT_DT#
      , #CHNL_CD#
      )
    </insert>


    <!--메시지 받기 관리-->
    <select id="S1134GetMailMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
      T10.MSG_NO
      , T10.ACPT_DT
      , T10.WRITE_DT
      , T10.WRITE_ID
      , T10.TIT_MSG
      , T10.LGIN_ID
      , T10.LGIN_ID + '-' + T10.CELL_PHN_NO + '-' +
      (    SELECT T4.CLSS_DESC
      FROM TB_SYS_CLSS_CD T4
      WHERE 1=1
      AND T4.CHNL_CD = #CHNL_CD#
      AND T4.CLSS_TP_CD = 'G-001'
      AND T4.CLSS_CD = T10.OPC_CD) AS OFC_PSN_NM
      FROM (
      SELECT
      T1.MSG_NO
      , T1.ACPT_DT
      , T2.WRITE_DT
      , T2.WRITE_ID
      , T1.LGIN_ID
      , (SELECT  T3.OFC_PSN_CD  FROM TB_SYS_USR T3 WHERE 1=1 AND T3.CHNL_CD = #CHNL_CD#  AND T1.LGIN_ID = T3.USR_ID) AS OPC_CD
      , (SELECT  T3.CELL_PHN_NO  FROM TB_SYS_USR T3 WHERE 1=1 AND T3.CHNL_CD = #CHNL_CD#  AND T1.LGIN_ID = T3.USR_ID) AS CELL_PHN_NO
      , T2.TIT_MSG
      FROM TB_SYS_MAILBX T1, TB_SYS_MAIL_LIST T2
      WHERE 1 = 1
      AND T1.CHNL_CD = #CHNL_CD#
      AND T1.CHNL_CD = T2.CHNL_CD
      AND T1.MSG_NO = T2.MSG_NO
      ) T10
    </select>

    <select id="S1134MailCheckSelect" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT T2.TIT_MSG
      FROM TB_SYS_MAILBX T1, TB_SYS_MAIL_LIST T2
      WHERE 1 = 1
      AND T1.CHNL_CD = #CHNL_CD#
      AND T1.CHNL_CD = T2.CHNL_CD
      AND T1.MSG_NO = T2.MSG_NO
    </select>

    <select id="S1134GetDateSelect" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="string">
      SELECT CONVERT(VARCHAR,GETDATE(),120)
    </select>

    <update id="S1134GetDateUpdate" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_SYS_MAILBX
      SET ACPT_DT = #ACPT_DT#
      WHERE 1=1
      AND MSG_NO = #MSG_NO#
      AND LGIN_ID = #LGIN_ID#
      AND CHNL_CD = #CHNL_CD#
    </update>

    
    
      <!--도면 기준 관리-->
     <select id="S1148SelectMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
        SELECT
        SHP_CO_CD
        , SHP_CLSS_COL_NM
        , SHP_SEQ
        , SHP_NO
        , SHP_TP_IMG
        , SHP_SZ
        , SHP_ITM_SZ
        , SHP_ITM_QTY
        , SHP_ITM_LEN
        , SHP_ITM_WGT
        , CHNL_CD
        FROM TB_CD_SHP_MAP
        WHERE 1=1
        AND CHNL_CD = #CHNL_CD#
     </select>
     
     
     <insert id="S1148InsertMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
        INSERT INTO TB_CD_SHP_MAP(
          SHP_CO_CD
        , SHP_CLSS_COL_NM
        , SHP_SEQ
        , SHP_NO
        , SHP_TP_IMG
        , SHP_SZ
        , SHP_ITM_SZ
        , SHP_ITM_QTY
        , SHP_ITM_LEN
        , SHP_ITM_WGT
        , CHNL_CD
        ) VALUES (
          #SHP_CO_CD#
        , #SHP_CLSS_COL_NM#
        , #SHP_SEQ#
        , #SHP_NO#
        , #SHP_TP_IMG#
        , #SHP_SZ#
        , #SHP_ITM_SZ#
        , #SHP_ITM_QTY#
        , #SHP_ITM_LEN#
        , #SHP_ITM_WGT#
        , #CHNL_CD#
        )
     </insert>

     <update id="S1148UpdateMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
        UPDATE TB_CD_SHP_MAP
        SET SHP_CLSS_COL_NM = #SHP_CLSS_COL_NM#
        , SHP_SEQ         = #SHP_SEQ#
        , SHP_NO         = #SHP_NO#
        , SHP_TP_IMG      = #SHP_TP_IMG#
        , SHP_SZ         = #SHP_SZ#
        , SHP_ITM_SZ      = #SHP_ITM_SZ#
        , SHP_ITM_QTY      = #SHP_ITM_QTY#
        , SHP_ITM_LEN      = #SHP_ITM_LEN#
        , SHP_ITM_WGT      = #SHP_ITM_WGT#
        WHERE 1=1
        AND SHP_CO_CD = #SHP_CO_CD#
        AND CHNL_CD = #CHNL_CD#
     </update>

     <delete id="S1148DeleteMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
        DELETE TB_CD_SHP_MAP
        WHERE 1=1
        AND SHP_CO_CD = #SHP_CO_CD#
        AND CHNL_CD = #CHNL_CD#
     </delete>





    <!--창고위치관리(완제품) - 조회-->
    <select id="S11472SelectMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
      SELECT
         CHNL_CD
        ,dbo.CD_SYS_CLSS_FNC(CHNL_CD, 'L-002', AREA_CD) AS AREA_NM
        ,AREA_CD
        ,dbo.CD_SYS_CLSS_FNC(CHNL_CD, 'C-008', N1ST_LOC_ID) AS N1ST_LOC_NM
        ,N1ST_LOC_ID
        ,dbo.CD_SYS_CLSS_FNC(CHNL_CD, 'C-009', N2ND_LOC_ID) AS N2ND_LOC_NM
        ,N2ND_LOC_ID
        ,N3RD_LOC_ID
        ,LOC_NM
        ,LOC_DESC
        ,INV_CAPA_WGT
        ,CONVERT(VARCHAR, CRE_DT , 23) AS CRE_DT
        ,CRE_USR_ID
        ,CONVERT(VARCHAR, UPD_DT , 23) AS UPD_DT
        ,UPD_USR_ID
      FROM TB_CD_ITM_LOC
      WHERE 1=1
      AND CHNL_CD = #CHNL_CD#
    </select>

    <!--창고위치관리(완제품) - 추가-->
    <insert id="S11472InsertMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      INSERT INTO TB_CD_ITM_LOC
      (
         CHNL_CD
        ,AREA_CD
        ,ITM_CD
        ,LOC_SEQ
        ,N1ST_LOC_ID
        ,N2ND_LOC_ID
        ,N3RD_LOC_ID
        ,LOC_NM
        ,CRE_USR_ID
        ,CRE_DT
        ,UPD_USR_ID
        ,UPD_DT
        ,LOC_DESC
        ,INV_CAPA_WGT
      )
      VALUES
      (
        #CHNL_CD#
        ,#AREA_CD#
        ,''
        ,0
        ,#N1ST_LOC_ID#
        ,#N2ND_LOC_ID#
        ,#N3RD_LOC_ID#
        ,#N1ST_LOC_ID# + '-' + #N2ND_LOC_ID#
        ,#CRE_USR_ID#
        ,GETDATE()
        ,#UPD_USR_ID#
        ,GETDATE()
        ,#LOC_DESC#
        ,#INV_CAPA_WGT#
      )

    </insert>



    <update id="S11472UpdateMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      UPDATE TB_CD_ITM_LOC
      SET N1ST_LOC_ID = #N1ST_LOC_ID#
        , N2ND_LOC_ID = #N2ND_LOC_ID#
        , INV_CAPA_WGT = #INV_CAPA_WGT#
        , LOC_DESC = #LOC_DESC#
        , LOC_NM = #N1ST_LOC_ID# + '-' + #N2ND_LOC_ID#
        , UPD_DT = GETDATE()
        , UPD_USR_ID = #UPD_USR_ID#
      WHERE 1=1
        AND CHNL_CD = #CHNL_CD#
        AND N1ST_LOC_ID = #N1ST_LOC_ID_TEMP#
        AND N2ND_LOC_ID = #N2ND_LOC_ID_TEMP#
    </update>


    <delete id="S11472DeleteMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
      DELETE  FROM TB_CD_ITM_LOC
      WHERE 1=1
        AND CHNL_CD = #CHNL_CD#
        AND N1ST_LOC_ID = #N1ST_LOC_ID#
        AND N2ND_LOC_ID = #N2ND_LOC_ID#
    </delete>
    
    
    
    <!-- 차량 마스터 관리 -->
    <select id="S1431SelectDtlList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
        SELECT  
            T1.CAR_NO
          , T1.CAR_NM
          , (SELECT TOP 1 CLSS_DESC from TB_SYS_CLSS_CD WHERE 1=1 AND CLSS_TP_CD = 'V-001' AND CLSS_CD=T1.CAR_OWN_CLSS ) AS CAR_OWN_CLSS
          , T1.REP_CAR_NO
          , (SELECT TOP 1 CLSS_DESC from TB_SYS_CLSS_CD WHERE 1=1 AND CLSS_TP_CD = 'V-002' AND CLSS_CD=T1.CAR_MAK_CD ) AS CAR_MAK_CD
          , (SELECT TOP 1 CLSS_DESC from TB_SYS_CLSS_CD WHERE 1=1 AND CLSS_TP_CD = 'V-003' AND CLSS_CD=T1.CAR_CLSS_CD ) AS CAR_CLSS_CD
          , T1.STK_WGT
          , T1.BIZ_CLSS_CD
          , T1.TRNS_MAN_NM
          , T1.TRNS_PHN_NO
          , T1.TRNS_LIC_NO
          , T1.TRNS_BIZ_LIC
          , T1.TRNS_MAN_ADDR
          , T1.TRNS_RMK
          , (SELECT TOP 1 CO_NM FROM TB_CD_CO WHERE 1=1 AND CO_NO = T1.CO_NO) AS CO_NO
          , T2.HDQTR_PST_NO
          , T2.CO_RGST_NO
          , T2.HDQTR_PHN_NO
          , T2.HDQTR_ADDR
          , (CASE WHEN T1.DELT_FLG = 'N' THEN '사용' ELSE '미사용' END) AS DELT_FLG
        FROM TB_CD_VEH T1
          , TB_CD_CO T2
          WHERE 1=1 
            AND T1.CHNL_CD  = #CHNL_CD# 
            AND T1.CO_NO    = T2.CO_NO 
            AND T1.CAR_NO   = #CAR_NO#
     </select>

     <select id="S1431SelectMstList" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
        SELECT 
              CAR_NO
            , CAR_NM
            , DELT_FLG
        FROM TB_CD_VEH
          WHERE 1=1
            AND CHNL_CD = #CHNL_CD#
          ORDER BY DELT_FLG , CAR_NO
     </select>
    
     <insert id="S1431InsertMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
        INSERT INTO TB_CD_VEH 
        (
            CHNL_CD
          , CAR_NO
          , CAR_NM
          , CAR_OWN_CLSS
          , REP_CAR_NO
          , CAR_CLSS_CD
          , CAR_MAK_CD
          , STK_WGT
          , BIZ_CLSS_CD
          , TRNS_MAN_NM
          , TRNS_PHN_NO
          , TRNS_LIC_NO
          , TRNS_BIZ_LIC
          , CO_NO
          , CRE_USR_ID
          , CRE_DT
          , UPD_USR_ID
          , UPD_DT
          , TRNS_MAN_ADDR
          , TRNS_RMK
          , DELT_FLG
        ) 
        VALUES
        (
            #CHNL_CD#
          , #CAR_NO#
          , #CAR_NM#
          , #CAR_OWN_CLSS#
          , #REP_CAR_NO#
          , #CAR_CLSS_CD#
          , #CAR_MAK_CD#
          , #STK_WGT#
          , #BIZ_CLSS_CD#
          , #TRNS_MAN_NM#
          , #TRNS_PHN_NO#
          , #TRNS_LIC_NO#
          , #TRNS_BIZ_LIC#
          , #CO_NO#
          , #CRE_USR_ID#
          , #CRE_DT#
          , #UPD_USR_ID#
          , #UPD_DT#
          , #TRNS_MAN_ADDR#
          , #TRNS_RMK#
          , #DELT_FLG#
        )
     </insert>
     <update id="S1431UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
        UPDATE TB_CD_VEH
        SET
          CAR_NM        = #CAR_NM#
        , CAR_OWN_CLSS  = #CAR_OWN_CLSS#
        , REP_CAR_NO    = #REP_CAR_NO#
        , CAR_MAK_CD    = #CAR_MAK_CD#
        , CAR_CLSS_CD   = #CAR_CLSS_CD#
        , STK_WGT       = #STK_WGT#
        , BIZ_CLSS_CD   = #BIZ_CLSS_CD#
        , TRNS_MAN_NM   = #TRNS_MAN_NM#
        , TRNS_PHN_NO   = #TRNS_PHN_NO#
        , TRNS_LIC_NO   = #TRNS_LIC_NO#
        , TRNS_BIZ_LIC  = #TRNS_BIZ_LIC#
        , CO_NO         = #CO_NO#
        , UPD_USR_ID    = #UPD_USR_ID#
        , UPD_DT        = #UPD_DT#
        , TRNS_MAN_ADDR = #TRNS_MAN_ADDR#
        , TRNS_RMK      = #TRNS_RMK#
        , DELT_FLG      = #DELT_FLG#
        WHERE 1=1
          AND CHNL_CD = #CHNL_CD#
          AND CAR_NO  = #CAR_NO#
     </update>
    
    
    
      <!--S11479 납품처관리 - 조회-->
    <select id="S11479SelectMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo" resultClass="ModelsLibrary.Code.SystemCodeVo">
          SELECT
                 T1.DE_PRNT_NO                                
                , T1.DE_CHD_NO
                , T1.CHNL_CD 
                <!--, T1.CO_NO-->                                 
                , T1.DE_CO_NM                              
               <!--, T1.DELT_FLG-->
                , CASE WHEN T1.DELT_FLG = 'N' THEN '사용' ELSE '미사용' END AS DELT_FLG
                , T1.DUE_DT                                
                , CONVERT(NVARCHAR, T1.DUE_DT, 23) AS S_DUE_DT                              
                , T1.CNTR_NM                               
                , T1.CNTR_RMK                               
                , T1.CRE_DT
                , CONVERT(NVARCHAR, T1.CRE_DT, 23) AS S_CRE_DT
                , T2.CO_NO     
                , T2.CO_NM
                , (T1.DE_CO_NM + '/' + T1.CNTR_NM) AS GBN
              FROM    TB_CD_DE T1 LEFT JOIN TB_CD_CO T2 ON (T1.CO_NO = T2.CO_NO AND T1.CHNL_CD = T2.CHNL_CD) 
                WHERE 1=1
                  AND T1.CHNL_CD = #CHNL_CD#
                <isNotNull property="DELT_FLG" >
                  AND T1.DELT_FLG = #DELT_FLG#
                </isNotNull>
                <isNotNull property="FM_DT" >
                  AND T1.CRE_DT    >= CAST(#FM_DT# + ' 00:00:00' AS DATETIME)
                  AND T1.CRE_DT    <![CDATA[<=]]> CAST(#TO_DT# + ' 23:59:59' AS DATETIME)
                </isNotNull>
                <isNotNull property="DE_PRNT_NO" >
                  AND DE_PRNT_NO = #DE_PRNT_NO#
                </isNotNull>
     </select>
    
    
    
     <!--S11479 납품처관리 - 부모 추가 -->
     <insert id="S11479InsertMaster" parameterClass="ModelsLibrary.Code.SystemCodeVo">
            INSERT INTO TB_CD_DE
            (
                 DE_PRNT_NO
               , CHNL_CD
               , CO_NO
               , DE_CO_NM
               , DELT_FLG
               , DUE_DT
               , CNTR_NM
               , CNTR_RMK
               , CRE_DT
               , CRE_USR_ID
               , UPD_DT
               , UPD_USR_ID
            )
            VALUES
            (
                 0
               , #CHNL_CD#
               , #CO_NO#
               , #DE_CO_NM#
               , #DELT_FLG#
               , #DUE_DT#
               , #CNTR_NM#
               , #CNTR_RMK#
               , GETDATE()
               , #CRE_USR_ID#
               , GETDATE()
               , #UPD_USR_ID#
            )
     </insert>


     <!--S11479 납품처관리 - 자식 추가 -->
     <insert id="S11479InsertDetail" parameterClass="ModelsLibrary.Code.SystemCodeVo">
            INSERT INTO TB_CD_DE
            (
                 DE_PRNT_NO
               , CHNL_CD
               , CO_NO
               , DE_CO_NM
               , DELT_FLG
               , DUE_DT
               , CNTR_NM
               , CNTR_RMK
               , CRE_DT
               , CRE_USR_ID
               , UPD_DT
               , UPD_USR_ID
            )
            VALUES
            (
                 #DE_PRNT_NO#
               , #CHNL_CD#
               , #CO_NO#
               , #DE_CO_NM#
               , #DELT_FLG#
               , #DUE_DT#
               , #CNTR_NM#
               , #CNTR_RMK#
               , #CRE_DT#
               , #CRE_USR_ID#
               , GETDATE()
               , #UPD_USR_ID#
            )
     </insert>

     <!--S11479 납품처관리 - 부모 수정 -->
     <update id="S11479UpdateMst" parameterClass="ModelsLibrary.Code.SystemCodeVo">
            UPDATE TB_CD_DE
               SET  CO_NO      = #CO_NO#
                  , DE_CO_NM   = #DE_CO_NM# 
                  , DELT_FLG   = #DELT_FLG#
                  , DUE_DT     = #DUE_DT#
                  , CNTR_NM    = #CNTR_NM#
                  , CNTR_RMK   = #CNTR_RMK#
              , CRE_DT     = #CRE_DT#
                  , UPD_DT     = GETDATE()
                  , UPD_USR_ID = #UPD_USR_ID#
             WHERE 1=1
             AND CHNL_CD   = #CHNL_CD#
             AND DE_CHD_NO = #DE_CHD_NO#
             AND CO_NO     = #CO_NO#
     </update>


     <!--S11479 납품처관리 - 자식 수정 -->
     <update id="S11479UpdateDtl" parameterClass="ModelsLibrary.Code.SystemCodeVo">
            UPDATE TB_CD_DE
               SET  DE_PRNT_NO = #DE_PRNT_NO#
                  , CO_NO      = #CO_NO#
                  , DE_CO_NM   = #DE_CO_NM# 
                  , DELT_FLG   = #DELT_FLG#
                  , DUE_DT     = #DUE_DT#
                  , CNTR_NM    = #CNTR_NM#
                  , CNTR_RMK   = #CNTR_RMK#
              , CRE_DT     = #CRE_DT#
                  , UPD_DT     = GETDATE()
                  , UPD_USR_ID = #UPD_USR_ID#
             WHERE 1=1
             AND CHNL_CD   = #CHNL_CD#
             AND DE_CHD_NO = #DE_CHD_NO#
             AND CO_NO     = #CO_NO#
     </update>
    
    
    
    
    
    
    
    
    
  </statements>
</sqlMap>